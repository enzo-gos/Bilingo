import e from"process";var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var i={};var n=e;"classList"in document.createElement("_")||function(e){if("Element"in e){var i="classList",n="prototype",o=e.Element[n],r=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[n].indexOf||function(e){var i=0,n=(this||t).length;for(;i<n;i++)if(i in(this||t)&&(this||t)[i]===e)return i;return-1},DOMEx=function(e,i){(this||t).name=e;(this||t).code=DOMException[e];(this||t).message=i},checkTokenAndGetIndex=function(e,t){if(""===t)throw new DOMEx("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new DOMEx("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(e,t)},ClassList=function(e){var i=s.call(e.getAttribute("class")||""),n=i?i.split(/\s+/):[],o=0,r=n.length;for(;o<r;o++)this.push(n[o]);(this||t)._updateClassName=function(){e.setAttribute("class",this.toString())}},l=ClassList[n]=[],classListGetter=function(){return new ClassList(this||t)};DOMEx[n]=Error[n];l.item=function(e){return(this||t)[e]||null};l.contains=function(e){e+="";return-1!==checkTokenAndGetIndex(this||t,e)};l.add=function(){var e=arguments,i=0,n=e.length,o,r=false;do{o=e[i]+"";if(-1===checkTokenAndGetIndex(this||t,o)){this.push(o);r=true}}while(++i<n);r&&this._updateClassName()};l.remove=function(){var e=arguments,i=0,n=e.length,o,r=false,s;do{o=e[i]+"";s=checkTokenAndGetIndex(this||t,o);while(-1!==s){this.splice(s,1);r=true;s=checkTokenAndGetIndex(this||t,o)}}while(++i<n);r&&this._updateClassName()};l.toggle=function(e,t){e+="";var i=this.contains(e),n=i?true!==t&&"remove":false!==t&&"add";n&&this[n](e);return true===t||false===t?t:!i};l.toString=function(){return this.join(" ")};if(r.defineProperty){var d={get:classListGetter,enumerable:true,configurable:true};try{r.defineProperty(o,i,d)}catch(e){if(-2146823252===e.number){d.enumerable=false;r.defineProperty(o,i,d)}}}else r[n].__defineGetter__&&o.__defineGetter__(i,classListGetter)}}(self);(function(e){e.URL=e.URL||e.webkitURL;if(e.Blob&&e.URL)try{new Blob;return}catch(e){}var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var get_class=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},i=function BlobBuilder(){(this||t).data=[]},n=function Blob(e,i,n){(this||t).data=e;(this||t).size=e.length;(this||t).type=i;(this||t).encoding=n},o=i.prototype,r=n.prototype,s=e.FileReaderSync,FileException=function(e){(this||t).code=(this||t)[(this||t).name=e]},a=("NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR "+"NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR").split(" "),l=a.length,d=e.URL||e.webkitURL||e,u=d.createObjectURL,c=d.revokeObjectURL,h=d,m=e.btoa,f=e.atob,p=e.ArrayBuffer,g=e.Uint8Array,b=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;n.fake=r.fake=true;while(l--)FileException.prototype[a[l]]=l+1;d.createObjectURL||(h=e.URL=function(e){var t=document.createElementNS("http://www.w3.org/1999/xhtml","a"),i;t.href=e;if(!("origin"in t))if("data:"===t.protocol.toLowerCase())t.origin=null;else{i=e.match(b);t.origin=i&&i[1]}return t});h.createObjectURL=function(e){var t=e.type,i;null===t&&(t="application/octet-stream");if(e instanceof n){i="data:"+t;return"base64"===e.encoding?i+";base64,"+e.data:"URI"===e.encoding?i+","+decodeURIComponent(e.data):m?i+";base64,"+m(e.data):i+","+encodeURIComponent(e.data)}if(u)return u.call(d,e)};h.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&c&&c.call(d,e)};o.append=function(e){var i=(this||t).data;if(g&&(e instanceof p||e instanceof g)){var o="",r=new g(e),a=0,l=r.length;for(;a<l;a++)o+=String.fromCharCode(r[a]);i.push(o)}else if("Blob"===get_class(e)||"File"===get_class(e)){if(!s)throw new FileException("NOT_READABLE_ERR");var d=new s;i.push(d.readAsBinaryString(e))}else if(e instanceof n)"base64"===e.encoding&&f?i.push(f(e.data)):"URI"===e.encoding?i.push(decodeURIComponent(e.data)):"raw"===e.encoding&&i.push(e.data);else{"string"!==typeof e&&(e+="");i.push(unescape(encodeURIComponent(e)))}};o.getBlob=function(e){arguments.length||(e=null);return new n((this||t).data.join(""),e,"raw")};o.toString=function(){return"[object BlobBuilder]"};r.slice=function(e,i,o){var r=arguments.length;r<3&&(o=null);return new n((this||t).data.slice(e,r>1?i:(this||t).data.length),o,(this||t).encoding)};r.toString=function(){return"[object Blob]"};r.close=function(){(this||t).size=0;delete(this||t).data};return i}(e);e.Blob=function(e,t){var n=t&&t.type||"";var o=new i;if(e)for(var r=0,s=e.length;r<s;r++)Uint8Array&&e[r]instanceof Uint8Array?o.append(e[r].buffer):o.append(e[r]);var a=o.getBlob(n);!a.slice&&a.webkitSlice&&(a.slice=a.webkitSlice);return a};var n=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=n(new e.Blob)})("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||i.content||i);(function(e,t){var o="undefined"!==typeof n&&n&&n.versions&&n.versions.electron;!o&&true?i=t:e.MediumEditor=t})(i,function(){function MediumEditor(e,t){return this.init(e,t)}MediumEditor.extensions={};(function(e){function copyInto(e,t){var i,n=Array.prototype.slice.call(arguments,2);t=t||{};for(var o=0;o<n.length;o++){var r=n[o];if(r)for(i in r)r.hasOwnProperty(i)&&"undefined"!==typeof r[i]&&(e||false===t.hasOwnProperty(i))&&(t[i]=r[i])}return t}var i=false;try{var n=document.createElement("div"),o=document.createTextNode(" ");n.appendChild(o);i=n.contains(o)}catch(e){}var r={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),isEdge:null!==/Edge\/\d+/.exec(navigator.userAgent),isFF:navigator.userAgent.toLowerCase().indexOf("firefox")>-1,isMac:e.navigator.platform.toUpperCase().indexOf("MAC")>=0,keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,K:75,M:77,V:86},isMetaCtrlKey:function(e){return!!(r.isMac&&e.metaKey||!r.isMac&&e.ctrlKey)},isKey:function(e,t){var i=r.getKeyCode(e);return false===Array.isArray(t)?i===t:-1!==t.indexOf(i)},getKeyCode:function(e){var t=e.which;null===t&&(t=null!==e.charCode?e.charCode:e.keyCode);return t},blockContainerElementNames:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","li","ol","address","article","aside","audio","canvas","dd","dl","dt","fieldset","figcaption","figure","footer","form","header","hgroup","main","nav","noscript","output","section","video","table","thead","tbody","tfoot","tr","th","td"],emptyElementNames:["br","col","colgroup","hr","img","input","source","wbr"],extend:function extend(){var e=[true].concat(Array.prototype.slice.call(arguments));return copyInto.apply(this||t,e)},defaults:function defaults(){var e=[false].concat(Array.prototype.slice.call(arguments));return copyInto.apply(this||t,e)},createLink:function(e,t,i,n){var o=e.createElement("a");r.moveTextRangeIntoElement(t[0],t[t.length-1],o);o.setAttribute("href",i);if(n){"_blank"===n&&o.setAttribute("rel","noopener noreferrer");o.setAttribute("target",n)}return o},findOrCreateMatchingTextNodes:function(e,t,i){var n=e.createTreeWalker(t,NodeFilter.SHOW_ALL,null,false),o=[],s=0,a=false,l=null,d=null;while(null!==(l=n.nextNode()))if(!(l.nodeType>3))if(3===l.nodeType){if(!a&&i.start<s+l.nodeValue.length){a=true;d=r.splitStartNodeIfNeeded(l,i.start,s)}a&&r.splitEndNodeIfNeeded(l,d,i.end,s);if(a&&s===i.end)break;if(a&&s>i.end+1)throw new Error("PerformLinking overshot the target!");a&&o.push(d||l);s+=l.nodeValue.length;if(null!==d){s+=d.nodeValue.length;n.nextNode()}d=null}else if("img"===l.tagName.toLowerCase()){!a&&i.start<=s&&(a=true);a&&o.push(l)}return o},splitStartNodeIfNeeded:function(e,t,i){return t!==i?e.splitText(t-i):null},splitEndNodeIfNeeded:function(e,t,i,n){var o,r;o=n+e.nodeValue.length+(t?t.nodeValue.length:0)-1;r=i-n-(t?e.nodeValue.length:0);o>=i&&n!==o&&0!==r&&(t||e).splitText(r)},splitByBlockElements:function(e){if(3!==e.nodeType&&1!==e.nodeType)return[];var t=[],i=MediumEditor.util.blockContainerElementNames.join(",");if(3===e.nodeType||0===e.querySelectorAll(i).length)return[e];for(var n=0;n<e.childNodes.length;n++){var o=e.childNodes[n];if(3===o.nodeType)t.push(o);else if(1===o.nodeType){var r=o.querySelectorAll(i);0===r.length?t.push(o):t=t.concat(MediumEditor.util.splitByBlockElements(o))}}return t},findAdjacentTextNodeWithContent:function findAdjacentTextNodeWithContent(e,t,i){var n=false,o,r=i.createNodeIterator(e,NodeFilter.SHOW_TEXT,null,false);o=r.nextNode();while(o){if(o===t)n=true;else if(n&&3===o.nodeType&&o.nodeValue&&o.nodeValue.trim().length>0)break;o=r.nextNode()}return o},findPreviousSibling:function(e){if(!e||r.isMediumEditorElement(e))return false;var t=e.previousSibling;while(!t&&!r.isMediumEditorElement(e.parentNode)){e=e.parentNode;t=e.previousSibling}return t},isDescendant:function isDescendant(e,t,n){if(!e||!t)return false;if(e===t)return!!n;if(1!==e.nodeType)return false;if(i||3!==t.nodeType)return e.contains(t);var o=t.parentNode;while(null!==o){if(o===e)return true;o=o.parentNode}return false},isElement:function isElement(e){return!!(e&&1===e.nodeType)},throttle:function(e,i){var n=50,o,r,s,a=null,l=0,later=function(){l=Date.now();a=null;s=e.apply(o,r);a||(o=r=null)};i||0===i||(i=n);return function(){var n=Date.now(),d=i-(n-l);o=this||t;r=arguments;if(d<=0||d>i){if(a){clearTimeout(a);a=null}l=n;s=e.apply(o,r);a||(o=r=null)}else a||(a=setTimeout(later,d));return s}},traverseUp:function(e,t){if(!e)return false;do{if(1===e.nodeType){if(t(e))return e;if(r.isMediumEditorElement(e))return false}e=e.parentNode}while(e);return false},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(e,t){var i,n,o,s,a,l,d,u=false,c=["insertHTML",false,t];if(!MediumEditor.util.isEdge&&e.queryCommandSupported("insertHTML"))try{return e.execCommand.apply(e,c)}catch(e){}i=e.getSelection();if(i.rangeCount){n=i.getRangeAt(0);d=n.commonAncestorContainer;if(r.isMediumEditorElement(d)&&!d.firstChild)n.selectNode(d.appendChild(e.createTextNode("")));else if(3===d.nodeType&&0===n.startOffset&&n.endOffset===d.nodeValue.length||3!==d.nodeType&&d.innerHTML===n.toString()){while(!r.isMediumEditorElement(d)&&d.parentNode&&1===d.parentNode.childNodes.length&&!r.isMediumEditorElement(d.parentNode))d=d.parentNode;n.selectNode(d)}n.deleteContents();o=e.createElement("div");o.innerHTML=t;s=e.createDocumentFragment();while(o.firstChild){a=o.firstChild;l=s.appendChild(a)}n.insertNode(s);if(l){n=n.cloneRange();n.setStartAfter(l);n.collapse(true);MediumEditor.selection.selectRange(e,n)}u=true}e.execCommand.callListeners&&e.execCommand.callListeners(c,u);return u},execFormatBlock:function(e,t){var i=r.getTopBlockContainer(MediumEditor.selection.getSelectionStart(e)),n;if("blockquote"===t){if(i){n=Array.prototype.slice.call(i.childNodes);if(n.some((function(e){return r.isBlockContainer(e)})))return e.execCommand("outdent",false,null)}if(r.isIE)return e.execCommand("indent",false,t)}i&&t===i.nodeName.toLowerCase()&&(t="p");r.isIE&&(t="<"+t+">");if(i&&"blockquote"===i.nodeName.toLowerCase()){if(r.isIE&&"<p>"===t)return e.execCommand("outdent",false,t);if((r.isFF||r.isEdge)&&"p"===t){n=Array.prototype.slice.call(i.childNodes);n.some((function(e){return!r.isBlockContainer(e)}))&&e.execCommand("formatBlock",false,t);return e.execCommand("outdent",false,t)}}return e.execCommand("formatBlock",false,t)},setTargetBlank:function(e,t){var i,n=t||false;if("a"===e.nodeName.toLowerCase()){e.target="_blank";e.rel="noopener noreferrer"}else{e=e.getElementsByTagName("a");for(i=0;i<e.length;i+=1)if(false===n||n===e[i].attributes.href.value){e[i].target="_blank";e[i].rel="noopener noreferrer"}}},removeTargetBlank:function(e,t){var i;if("a"===e.nodeName.toLowerCase()){e.removeAttribute("target");e.removeAttribute("rel")}else{e=e.getElementsByTagName("a");for(i=0;i<e.length;i+=1)if(t===e[i].attributes.href.value){e[i].removeAttribute("target");e[i].removeAttribute("rel")}}},addClassToAnchors:function(e,t){var i=t.split(" "),n,o;if("a"===e.nodeName.toLowerCase())for(o=0;o<i.length;o+=1)e.classList.add(i[o]);else{var s=e.getElementsByTagName("a");if(0===s.length){var a=r.getClosestTag(e,"a");e=a?[a]:[]}else e=s;for(n=0;n<e.length;n+=1)for(o=0;o<i.length;o+=1)e[n].classList.add(i[o])}},isListItem:function(e){if(!e)return false;if("li"===e.nodeName.toLowerCase())return true;var t=e.parentNode,i=t.nodeName.toLowerCase();while("li"===i||!r.isBlockContainer(t)&&"div"!==i){if("li"===i)return true;t=t.parentNode;if(!t)return false;i=t.nodeName.toLowerCase()}return false},cleanListDOM:function(e,t){if("li"===t.nodeName.toLowerCase()){var i=t.parentElement;if("p"===i.parentElement.nodeName.toLowerCase()){r.unwrap(i.parentElement,e);MediumEditor.selection.moveCursor(e,t.firstChild,t.firstChild.textContent.length)}}},splitOffDOMTree:function(e,t,i){var n=t,o=null,r=!i;while(n!==e){var s=n.parentNode,a=s.cloneNode(false),l=r?n:s.firstChild,d;o&&(r?a.appendChild(o):d=o);o=a;while(l){var u=l.nextSibling;if(l===n){l.hasChildNodes()?l=l.cloneNode(false):l.parentNode.removeChild(l);l.textContent&&o.appendChild(l);l=r?u:null}else{l.parentNode.removeChild(l);(l.hasChildNodes()||l.textContent)&&o.appendChild(l);l=u}}d&&o.appendChild(d);n=s}return o},moveTextRangeIntoElement:function(e,t,i){if(!e||!t)return false;var n=r.findCommonRoot(e,t);if(!n)return false;if(t===e){var o=e.parentNode,s=e.nextSibling;o.removeChild(e);i.appendChild(e);s?o.insertBefore(i,s):o.appendChild(i);return i.hasChildNodes()}var a=[],l,d,u;for(var c=0;c<n.childNodes.length;c++){u=n.childNodes[c];if(l){if(r.isDescendant(u,t,true)){d=u;break}a.push(u)}else r.isDescendant(u,e,true)&&(l=u)}var h=d.nextSibling,m=n.ownerDocument.createDocumentFragment();if(l===e){l.parentNode.removeChild(l);m.appendChild(l)}else m.appendChild(r.splitOffDOMTree(l,e));a.forEach((function(e){e.parentNode.removeChild(e);m.appendChild(e)}));if(d===t){d.parentNode.removeChild(d);m.appendChild(d)}else m.appendChild(r.splitOffDOMTree(d,t,true));i.appendChild(m);d.parentNode===n?n.insertBefore(i,d):h?n.insertBefore(i,h):n.appendChild(i);return i.hasChildNodes()},depthOfNode:function(e){var t=0,i=e;while(null!==i.parentNode){i=i.parentNode;t++}return t},findCommonRoot:function(e,t){var i=r.depthOfNode(e),n=r.depthOfNode(t),o=e,s=t;while(i!==n)if(i>n){o=o.parentNode;i-=1}else{s=s.parentNode;n-=1}while(o!==s){o=o.parentNode;s=s.parentNode}return o},isElementAtBeginningOfBlock:function(e){var t,i;while(!r.isBlockContainer(e)&&!r.isMediumEditorElement(e)){i=e;while(i=i.previousSibling){t=3===i.nodeType?i.nodeValue:i.textContent;if(t.length>0)return false}e=e.parentNode}return true},isMediumEditorElement:function(e){return e&&e.getAttribute&&!!e.getAttribute("data-medium-editor-element")},getContainerEditorElement:function(e){return r.traverseUp(e,(function(e){return r.isMediumEditorElement(e)}))},isBlockContainer:function(e){return e&&3!==e.nodeType&&-1!==r.blockContainerElementNames.indexOf(e.nodeName.toLowerCase())},getClosestBlockContainer:function(e){return r.traverseUp(e,(function(e){return r.isBlockContainer(e)||r.isMediumEditorElement(e)}))},getTopBlockContainer:function(e){var t=!!r.isBlockContainer(e)&&e;r.traverseUp(e,(function(e){r.isBlockContainer(e)&&(t=e);if(!t&&r.isMediumEditorElement(e)){t=e;return true}return false}));return t},getFirstSelectableLeafNode:function(e){while(e&&e.firstChild)e=e.firstChild;e=r.traverseUp(e,(function(e){return-1===r.emptyElementNames.indexOf(e.nodeName.toLowerCase())}));if("table"===e.nodeName.toLowerCase()){var t=e.querySelector("th, td");t&&(e=t)}return e},getFirstTextNode:function(e){r.warn("getFirstTextNode is deprecated and will be removed in version 6.0.0");return r._getFirstTextNode(e)},_getFirstTextNode:function(e){if(3===e.nodeType)return e;for(var t=0;t<e.childNodes.length;t++){var i=r._getFirstTextNode(e.childNodes[t]);if(null!==i)return i}return null},ensureUrlHasProtocol:function(e){return-1===e.indexOf("://")?"http://"+e:e},warn:function(){void 0!==e.console&&"function"===typeof e.console.warn&&e.console.warn.apply(e.console,arguments)},deprecated:function(e,t,i){var n=e+" is deprecated, please use "+t+" instead.";i&&(n+=" Will be removed in "+i);r.warn(n)},deprecatedMethod:function(e,i,n,o){r.deprecated(e,i,o);"function"===typeof(this||t)[i]&&(this||t)[i].apply(this||t,n)},cleanupAttrs:function(e,t){t.forEach((function(t){e.removeAttribute(t)}))},cleanupTags:function(e,t){-1!==t.indexOf(e.nodeName.toLowerCase())&&e.parentNode.removeChild(e)},unwrapTags:function(e,t){-1!==t.indexOf(e.nodeName.toLowerCase())&&MediumEditor.util.unwrap(e,document)},getClosestTag:function(e,t){return r.traverseUp(e,(function(e){return e.nodeName.toLowerCase()===t.toLowerCase()}))},unwrap:function(e,t){var i=t.createDocumentFragment(),n=Array.prototype.slice.call(e.childNodes);for(var o=0;o<n.length;o++)i.appendChild(n[o]);i.childNodes.length?e.parentNode.replaceChild(i,e):e.parentNode.removeChild(e)},guid:function(){function _s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return _s4()+_s4()+"-"+_s4()+"-"+_s4()+"-"+_s4()+"-"+_s4()+_s4()+_s4()}};MediumEditor.util=r})(window);(function(){var Extension=function(e){MediumEditor.util.extend(this||t,e)};Extension.extend=function(e){var i=this||t,n;n=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return i.apply(this||t,arguments)};MediumEditor.util.extend(n,i);var Surrogate=function(){(this||t).constructor=n};Surrogate.prototype=i.prototype;n.prototype=new Surrogate;e&&MediumEditor.util.extend(n.prototype,e);return n};Extension.prototype={init:function(){},base:void 0,name:void 0,checkState:void 0,destroy:void 0,queryCommandState:void 0,isActive:void 0,isAlreadyApplied:void 0,setActive:void 0,setInactive:void 0,getInteractionElements:void 0,window:void 0,document:void 0,getEditorElements:function(){return(this||t).base.elements},getEditorId:function(){return(this||t).base.id},getEditorOption:function(e){return(this||t).base.options[e]}};["execAction","on","off","subscribe","trigger"].forEach((function(e){Extension.prototype[e]=function(){return(this||t).base[e].apply((this||t).base,arguments)}}));MediumEditor.Extension=Extension})();(function(){function filterOnlyParentElements(e){return MediumEditor.util.isBlockContainer(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}var e={findMatchingSelectionParent:function(e,t){var i=t.getSelection(),n,o;if(0===i.rangeCount)return false;n=i.getRangeAt(0);o=n.commonAncestorContainer;return MediumEditor.util.traverseUp(o,e)},getSelectionElement:function(e){return this.findMatchingSelectionParent((function(e){return MediumEditor.util.isMediumEditorElement(e)}),e)},exportSelection:function(e,t){if(!e)return null;var i=null,n=t.getSelection();if(n.rangeCount>0){var o=n.getRangeAt(0),r=o.cloneRange(),s;r.selectNodeContents(e);r.setEnd(o.startContainer,o.startOffset);s=r.toString().length;i={start:s,end:s+o.toString().length};this.doesRangeStartWithImages(o,t)&&(i.startsWithImage=true);var a=this.getTrailingImageCount(e,i,o.endContainer,o.endOffset);a&&(i.trailingImageCount=a);if(0!==s){var l=this.getIndexRelativeToAdjacentEmptyBlocks(t,e,o.startContainer,o.startOffset);-1!==l&&(i.emptyBlocksIndex=l)}}return i},importSelection:function(e,t,i,n){if(e&&t){var o=i.createRange();o.setStart(t,0);o.collapse(true);var r=t,s=[],a=0,l=false,d=false,u=0,c=false,h,m=false,f=null;(n||e.startsWithImage||"undefined"!==typeof e.emptyBlocksIndex)&&(m=true);while(!c&&r)if(r.nodeType>3)r=s.pop();else{if(3!==r.nodeType||d){if(e.trailingImageCount&&d){"img"===r.nodeName.toLowerCase()&&u++;if(u===e.trailingImageCount){var p=0;while(r.parentNode.childNodes[p]!==r)p++;o.setEnd(r.parentNode,p+1);c=true}}if(!c&&1===r.nodeType){var g=r.childNodes.length-1;while(g>=0){s.push(r.childNodes[g]);g-=1}}}else{h=a+r.length;if(!l&&e.start>=a&&e.start<=h)if(m||e.start<h){o.setStart(r,e.start-a);l=true}else f=r;if(l&&e.end>=a&&e.end<=h)if(e.trailingImageCount)d=true;else{o.setEnd(r,e.end-a);c=true}a=h}c||(r=s.pop())}if(!l&&f){o.setStart(f,f.length);o.setEnd(f,f.length)}"undefined"!==typeof e.emptyBlocksIndex&&(o=this.importSelectionMoveCursorPastBlocks(i,t,e.emptyBlocksIndex,o));n&&(o=this.importSelectionMoveCursorPastAnchor(e,o));this.selectRange(i,o)}},importSelectionMoveCursorPastAnchor:function(e,t){var nodeInsideAnchorTagFunction=function(e){return"a"===e.nodeName.toLowerCase()};if(e.start===e.end&&3===t.startContainer.nodeType&&t.startOffset===t.startContainer.nodeValue.length&&MediumEditor.util.traverseUp(t.startContainer,nodeInsideAnchorTagFunction)){var i=t.startContainer,n=t.startContainer.parentNode;while(null!==n&&"a"!==n.nodeName.toLowerCase())if(n.childNodes[n.childNodes.length-1]!==i)n=null;else{i=n;n=n.parentNode}if(null!==n&&"a"===n.nodeName.toLowerCase()){var o=null;for(var r=0;null===o&&r<n.parentNode.childNodes.length;r++)n.parentNode.childNodes[r]===n&&(o=r);t.setStart(n.parentNode,o+1);t.collapse(true)}}return t},importSelectionMoveCursorPastBlocks:function(e,t,i,n){var o=e.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,filterOnlyParentElements,false),r=n.startContainer,s,a,l=0;i=i||1;s=3===r.nodeType&&MediumEditor.util.isBlockContainer(r.previousSibling)?r.previousSibling:MediumEditor.util.getClosestBlockContainer(r);while(o.nextNode())if(a){a=o.currentNode;l++;if(l===i)break;if(a.textContent.length>0)break}else s===o.currentNode&&(a=o.currentNode);a||(a=s);n.setStart(MediumEditor.util.getFirstSelectableLeafNode(a),0);return n},getIndexRelativeToAdjacentEmptyBlocks:function(e,t,i,n){if(i.textContent.length>0&&n>0)return-1;var o=i;3!==o.nodeType&&(o=i.childNodes[n]);if(o){if(!MediumEditor.util.isElementAtBeginningOfBlock(o))return-1;var r=MediumEditor.util.findPreviousSibling(o);if(!r)return-1;if(r.nodeValue)return-1}var s=MediumEditor.util.getClosestBlockContainer(i),a=e.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,filterOnlyParentElements,false),l=0;while(a.nextNode()){var d=""===a.currentNode.textContent;(d||l>0)&&(l+=1);if(a.currentNode===s)return l;d||(l=0)}return l},doesRangeStartWithImages:function(e,t){if(0!==e.startOffset||1!==e.startContainer.nodeType)return false;if("img"===e.startContainer.nodeName.toLowerCase())return true;var i=e.startContainer.querySelector("img");if(!i)return false;var n=t.createTreeWalker(e.startContainer,NodeFilter.SHOW_ALL,null,false);while(n.nextNode()){var o=n.currentNode;if(o===i)break;if(o.nodeValue)return false}return true},getTrailingImageCount:function(e,t,i,n){if(0===n||1!==i.nodeType)return 0;if("img"!==i.nodeName.toLowerCase()&&!i.querySelector("img"))return 0;var o=i.childNodes[n-1];while(o.hasChildNodes())o=o.lastChild;var r=e,s=[],a=0,l=false,d=false,u=false,c,h=0;while(!u&&r)if(r.nodeType>3)r=s.pop();else{if(3!==r.nodeType||d){"img"===r.nodeName.toLowerCase()&&h++;if(r===o)u=true;else if(1===r.nodeType){var m=r.childNodes.length-1;while(m>=0){s.push(r.childNodes[m]);m-=1}}}else{h=0;c=a+r.length;!l&&t.start>=a&&t.start<=c&&(l=true);l&&t.end>=a&&t.end<=c&&(d=true);a=c}u||(r=s.pop())}return h},selectionContainsContent:function(e){var t=e.getSelection();if(!t||t.isCollapsed||!t.rangeCount)return false;if(""!==t.toString().trim())return true;var i=this.getSelectedParentElement(t.getRangeAt(0));return!(!i||!("img"===i.nodeName.toLowerCase()||1===i.nodeType&&i.querySelector("img")))},selectionInContentEditableFalse:function(e){var t,i=this.findMatchingSelectionParent((function(e){var i=e&&e.getAttribute("contenteditable");"true"===i&&(t=true);return"#text"!==e.nodeName&&"false"===i}),e);return!t&&i},getSelectionHtml:function getSelectionHtml(e){var t,i="",n=e.getSelection(),o,r;if(n.rangeCount){r=e.createElement("div");for(t=0,o=n.rangeCount;t<o;t+=1)r.appendChild(n.getRangeAt(t).cloneContents());i=r.innerHTML}return i},getCaretOffsets:function getCaretOffsets(e,t){var i,n;t||(t=window.getSelection().getRangeAt(0));i=t.cloneRange();n=t.cloneRange();i.selectNodeContents(e);i.setEnd(t.endContainer,t.endOffset);n.selectNodeContents(e);n.setStart(t.endContainer,t.endOffset);return{left:i.toString().length,right:n.toString().length}},rangeSelectsSingleNode:function(e){var t=e.startContainer;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===e.startOffset+1},getSelectedParentElement:function(e){return e?this.rangeSelectsSingleNode(e)&&3!==e.startContainer.childNodes[e.startOffset].nodeType?e.startContainer.childNodes[e.startOffset]:3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer:null},getSelectedElements:function(e){var t=e.getSelection(),i,n,o;if(!t.rangeCount||t.isCollapsed||!t.getRangeAt(0).commonAncestorContainer)return[];i=t.getRangeAt(0);if(3===i.commonAncestorContainer.nodeType){n=[];o=i.commonAncestorContainer;while(o.parentNode&&1===o.parentNode.childNodes.length){n.push(o.parentNode);o=o.parentNode}return n}return[].filter.call(i.commonAncestorContainer.getElementsByTagName("*"),(function(e){return"function"!==typeof t.containsNode||t.containsNode(e,true)}))},selectNode:function(e,t){var i=t.createRange();i.selectNodeContents(e);this.selectRange(t,i)},select:function(e,t,i,n,o){var r=e.createRange();r.setStart(t,i);n?r.setEnd(n,o):r.collapse(true);this.selectRange(e,r);return r},clearSelection:function(e,t){t?e.getSelection().collapseToStart():e.getSelection().collapseToEnd()},moveCursor:function(e,t,i){this.select(e,t,i)},getSelectionRange:function(e){var t=e.getSelection();return 0===t.rangeCount?null:t.getRangeAt(0)},selectRange:function(e,t){var i=e.getSelection();i.removeAllRanges();i.addRange(t)},getSelectionStart:function(e){var t=e.getSelection().anchorNode,i=t&&3===t.nodeType?t.parentNode:t;return i}};MediumEditor.selection=e})();(function(){function isElementDescendantOfExtension(e,t){return!!e&&e.some((function(e){if("function"!==typeof e.getInteractionElements)return false;var i=e.getInteractionElements();if(!i)return false;Array.isArray(i)||(i=[i]);return i.some((function(e){return MediumEditor.util.isDescendant(e,t,true)}))}))}var Events=function(e){(this||t).base=e;(this||t).options=(this||t).base.options;(this||t).events=[];(this||t).disabledEvents={};(this||t).customEvents={};(this||t).listeners={}};Events.prototype={InputEventOnContenteditableSupported:!MediumEditor.util.isIE&&!MediumEditor.util.isEdge,attachDOMEvent:function(e,i,n,o){var r=(this||t).base.options.contentWindow,s=(this||t).base.options.ownerDocument;e=MediumEditor.util.isElement(e)||[r,s].indexOf(e)>-1?[e]:e;Array.prototype.forEach.call(e,function(e){e.addEventListener(i,n,o);(this||t).events.push([e,i,n,o])}.bind(this||t))},detachDOMEvent:function(e,i,n,o){var r,s,a=(this||t).base.options.contentWindow,l=(this||t).base.options.ownerDocument;if(e){e=MediumEditor.util.isElement(e)||[a,l].indexOf(e)>-1?[e]:e;Array.prototype.forEach.call(e,function(e){r=this.indexOfListener(e,i,n,o);if(-1!==r){s=(this||t).events.splice(r,1)[0];s[0].removeEventListener(s[1],s[2],s[3])}}.bind(this||t))}},indexOfListener:function(e,i,n,o){var r,s,a;for(r=0,s=(this||t).events.length;r<s;r+=1){a=(this||t).events[r];if(a[0]===e&&a[1]===i&&a[2]===n&&a[3]===o)return r}return-1},detachAllDOMEvents:function(){var e=(this||t).events.pop();while(e){e[0].removeEventListener(e[1],e[2],e[3]);e=(this||t).events.pop()}},detachAllEventsFromElement:function(e){var i=(this||t).events.filter((function(t){return t&&t[0].getAttribute&&t[0].getAttribute("medium-editor-index")===e.getAttribute("medium-editor-index")}));for(var n=0,o=i.length;n<o;n++){var r=i[n];this.detachDOMEvent(r[0],r[1],r[2],r[3])}},attachAllEventsToElement:function(e){(this||t).listeners["editableInput"]&&((this||t).contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML);(this||t).eventsCache&&(this||t).eventsCache.forEach((function(i){this.attachDOMEvent(e,i["name"],i["handler"].bind(this||t))}),this||t)},enableCustomEvent:function(e){void 0!==(this||t).disabledEvents[e]&&delete(this||t).disabledEvents[e]},disableCustomEvent:function(e){(this||t).disabledEvents[e]=true},attachCustomEvent:function(e,i){this.setupListener(e);(this||t).customEvents[e]||((this||t).customEvents[e]=[]);(this||t).customEvents[e].push(i)},detachCustomEvent:function(e,i){var n=this.indexOfCustomListener(e,i);-1!==n&&(this||t).customEvents[e].splice(n,1)},indexOfCustomListener:function(e,i){return(this||t).customEvents[e]&&(this||t).customEvents[e].length?(this||t).customEvents[e].indexOf(i):-1},detachAllCustomEvents:function(){(this||t).customEvents={}},triggerCustomEvent:function(e,i,n){(this||t).customEvents[e]&&!(this||t).disabledEvents[e]&&(this||t).customEvents[e].forEach((function(e){e(i,n)}))},destroy:function(){this.detachAllDOMEvents();this.detachAllCustomEvents();this.detachExecCommand();(this||t).base.elements&&(this||t).base.elements.forEach((function(e){e.removeAttribute("data-medium-focused")}))},attachToExecCommand:function(){if(!(this||t).execCommandListener){(this||t).execCommandListener=function(e){this.handleDocumentExecCommand(e)}.bind(this||t);this.wrapExecCommand();(this||t).options.ownerDocument.execCommand.listeners.push((this||t).execCommandListener)}},detachExecCommand:function(){var e=(this||t).options.ownerDocument;if((this||t).execCommandListener&&e.execCommand.listeners){var i=e.execCommand.listeners.indexOf((this||t).execCommandListener);-1!==i&&e.execCommand.listeners.splice(i,1);e.execCommand.listeners.length||this.unwrapExecCommand()}},wrapExecCommand:function(){var e=(this||t).options.ownerDocument;if(!e.execCommand.listeners){var callListeners=function(t,i){e.execCommand.listeners&&e.execCommand.listeners.forEach((function(e){e({command:t[0],value:t[2],args:t,result:i})}))},wrapper=function(){var i=e.execCommand.orig.apply(this||t,arguments);if(!e.execCommand.listeners)return i;var n=Array.prototype.slice.call(arguments);callListeners(n,i);return i};wrapper.orig=e.execCommand;wrapper.listeners=[];wrapper.callListeners=callListeners;e.execCommand=wrapper}},unwrapExecCommand:function(){var e=(this||t).options.ownerDocument;e.execCommand.orig&&(e.execCommand=e.execCommand.orig)},setupListener:function(e){if(!(this||t).listeners[e]){switch(e){case"externalInteraction":this.attachDOMEvent((this||t).options.ownerDocument.body,"mousedown",(this||t).handleBodyMousedown.bind(this||t),true);this.attachDOMEvent((this||t).options.ownerDocument.body,"click",(this||t).handleBodyClick.bind(this||t),true);this.attachDOMEvent((this||t).options.ownerDocument.body,"focus",(this||t).handleBodyFocus.bind(this||t),true);break;case"blur":this.setupListener("externalInteraction");break;case"focus":this.setupListener("externalInteraction");break;case"editableInput":(this||t).contentCache={};(this||t).base.elements.forEach((function(e){(this||t).contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML}),this||t);(this||t).InputEventOnContenteditableSupported&&this.attachToEachElement("input",(this||t).handleInput);if(!(this||t).InputEventOnContenteditableSupported){this.setupListener("editableKeypress");(this||t).keypressUpdateInput=true;this.attachDOMEvent(document,"selectionchange",(this||t).handleDocumentSelectionChange.bind(this||t));this.attachToExecCommand()}break;case"editableClick":this.attachToEachElement("click",(this||t).handleClick);break;case"editableBlur":this.attachToEachElement("blur",(this||t).handleBlur);break;case"editableKeypress":this.attachToEachElement("keypress",(this||t).handleKeypress);break;case"editableKeyup":this.attachToEachElement("keyup",(this||t).handleKeyup);break;case"editableKeydown":this.attachToEachElement("keydown",(this||t).handleKeydown);break;case"editableKeydownSpace":this.setupListener("editableKeydown");break;case"editableKeydownEnter":this.setupListener("editableKeydown");break;case"editableKeydownTab":this.setupListener("editableKeydown");break;case"editableKeydownDelete":this.setupListener("editableKeydown");break;case"editableMouseover":this.attachToEachElement("mouseover",(this||t).handleMouseover);break;case"editableDrag":this.attachToEachElement("dragover",(this||t).handleDragging);this.attachToEachElement("dragleave",(this||t).handleDragging);break;case"editableDrop":this.attachToEachElement("drop",(this||t).handleDrop);break;case"editablePaste":this.attachToEachElement("paste",(this||t).handlePaste);break}(this||t).listeners[e]=true}},attachToEachElement:function(e,i){(this||t).eventsCache||((this||t).eventsCache=[]);(this||t).base.elements.forEach((function(n){this.attachDOMEvent(n,e,i.bind(this||t))}),this||t);(this||t).eventsCache.push({name:e,handler:i})},cleanupElement:function(e){var i=e.getAttribute("medium-editor-index");if(i){this.detachAllEventsFromElement(e);(this||t).contentCache&&delete(this||t).contentCache[i]}},focusElement:function(e){e.focus();this.updateFocus(e,{target:e,type:"focus"})},updateFocus:function(e,i){var n=(this||t).base.getFocusedElement(),o;n&&"click"===i.type&&(this||t).lastMousedownTarget&&(MediumEditor.util.isDescendant(n,(this||t).lastMousedownTarget,true)||isElementDescendantOfExtension((this||t).base.extensions,(this||t).lastMousedownTarget))&&(o=n);o||(this||t).base.elements.some((function(t){!o&&MediumEditor.util.isDescendant(t,e,true)&&(o=t);return!!o}),this||t);var r=!MediumEditor.util.isDescendant(n,e,true)&&!isElementDescendantOfExtension((this||t).base.extensions,e);if(o!==n){if(n&&r){n.removeAttribute("data-medium-focused");this.triggerCustomEvent("blur",i,n)}if(o){o.setAttribute("data-medium-focused",true);this.triggerCustomEvent("focus",i,o)}}r&&this.triggerCustomEvent("externalInteraction",i)},updateInput:function(e,i){if((this||t).contentCache){var n=e.getAttribute("medium-editor-index"),o=e.innerHTML;o!==(this||t).contentCache[n]&&this.triggerCustomEvent("editableInput",i,e);(this||t).contentCache[n]=o}},handleDocumentSelectionChange:function(e){if(e.currentTarget&&e.currentTarget.activeElement){var i=e.currentTarget.activeElement,n;(this||t).base.elements.some((function(e){if(MediumEditor.util.isDescendant(e,i,true)){n=e;return true}return false}),this||t);n&&this.updateInput(n,{target:i,currentTarget:n})}},handleDocumentExecCommand:function(){var e=(this||t).base.getFocusedElement();e&&this.updateInput(e,{target:e,currentTarget:e})},handleBodyClick:function(e){this.updateFocus(e.target,e)},handleBodyFocus:function(e){this.updateFocus(e.target,e)},handleBodyMousedown:function(e){(this||t).lastMousedownTarget=e.target},handleInput:function(e){this.updateInput(e.currentTarget,e)},handleClick:function(e){this.triggerCustomEvent("editableClick",e,e.currentTarget)},handleBlur:function(e){this.triggerCustomEvent("editableBlur",e,e.currentTarget)},handleKeypress:function(e){this.triggerCustomEvent("editableKeypress",e,e.currentTarget);if((this||t).keypressUpdateInput){var i={target:e.target,currentTarget:e.currentTarget};setTimeout(function(){this.updateInput(i.currentTarget,i)}.bind(this||t),0)}},handleKeyup:function(e){this.triggerCustomEvent("editableKeyup",e,e.currentTarget)},handleMouseover:function(e){this.triggerCustomEvent("editableMouseover",e,e.currentTarget)},handleDragging:function(e){this.triggerCustomEvent("editableDrag",e,e.currentTarget)},handleDrop:function(e){this.triggerCustomEvent("editableDrop",e,e.currentTarget)},handlePaste:function(e){this.triggerCustomEvent("editablePaste",e,e.currentTarget)},handleKeydown:function(e){this.triggerCustomEvent("editableKeydown",e,e.currentTarget);return MediumEditor.util.isKey(e,MediumEditor.util.keyCode.SPACE)?this.triggerCustomEvent("editableKeydownSpace",e,e.currentTarget):MediumEditor.util.isKey(e,MediumEditor.util.keyCode.ENTER)||e.ctrlKey&&MediumEditor.util.isKey(e,MediumEditor.util.keyCode.M)?this.triggerCustomEvent("editableKeydownEnter",e,e.currentTarget):MediumEditor.util.isKey(e,MediumEditor.util.keyCode.TAB)?this.triggerCustomEvent("editableKeydownTab",e,e.currentTarget):MediumEditor.util.isKey(e,[MediumEditor.util.keyCode.DELETE,MediumEditor.util.keyCode.BACKSPACE])?this.triggerCustomEvent("editableKeydownDelete",e,e.currentTarget):void 0}};MediumEditor.Events=Events})();(function(){var e=MediumEditor.Extension.extend({action:void 0,aria:void 0,tagNames:void 0,style:void 0,useQueryState:void 0,contentDefault:void 0,contentFA:void 0,classList:void 0,attrs:void 0,constructor:function(i){e.isBuiltInButton(i)?MediumEditor.Extension.call(this||t,(this||t).defaults[i]):MediumEditor.Extension.call(this||t,i)},init:function(){MediumEditor.Extension.prototype.init.apply(this||t,arguments);(this||t).button=this.createButton();this.on((this||t).button,"click",(this||t).handleClick.bind(this||t))},getButton:function(){return(this||t).button},getAction:function(){return"function"===typeof(this||t).action?this.action((this||t).base.options):(this||t).action},getAria:function(){return"function"===typeof(this||t).aria?this.aria((this||t).base.options):(this||t).aria},getTagNames:function(){return"function"===typeof(this||t).tagNames?this.tagNames((this||t).base.options):(this||t).tagNames},createButton:function(){var e=(this||t).document.createElement("button"),i=(this||t).contentDefault,n=this.getAria(),o=this.getEditorOption("buttonLabels");e.classList.add("medium-editor-action");e.classList.add("medium-editor-action-"+(this||t).name);(this||t).classList&&(this||t).classList.forEach((function(t){e.classList.add(t)}));e.setAttribute("data-action",this.getAction());if(n){e.setAttribute("title",n);e.setAttribute("aria-label",n)}(this||t).attrs&&Object.keys((this||t).attrs).forEach((function(i){e.setAttribute(i,(this||t).attrs[i])}),this||t);"fontawesome"===o&&(this||t).contentFA&&(i=(this||t).contentFA);e.innerHTML=i;return e},handleClick:function(e){e.preventDefault();e.stopPropagation();var t=this.getAction();t&&this.execAction(t)},isActive:function(){return(this||t).button.classList.contains(this.getEditorOption("activeButtonClass"))},setInactive:function(){(this||t).button.classList.remove(this.getEditorOption("activeButtonClass"));delete(this||t).knownState},setActive:function(){(this||t).button.classList.add(this.getEditorOption("activeButtonClass"));delete(this||t).knownState},queryCommandState:function(){var e=null;(this||t).useQueryState&&(e=(this||t).base.queryCommandState(this.getAction()));return e},isAlreadyApplied:function(e){var i=false,n=this.getTagNames(),o,r;if(false===(this||t).knownState||true===(this||t).knownState)return(this||t).knownState;n&&n.length>0&&(i=-1!==n.indexOf(e.nodeName.toLowerCase()));if(!i&&(this||t).style){o=(this||t).style.value.split("|");r=(this||t).window.getComputedStyle(e,null).getPropertyValue((this||t).style.prop);o.forEach((function(e){if(!(this||t).knownState){i=-1!==r.indexOf(e);(i||"text-decoration"!==(this||t).style.prop)&&((this||t).knownState=i)}}),this||t)}return i}});e.isBuiltInButton=function(e){return"string"===typeof e&&MediumEditor.extensions.button.prototype.defaults.hasOwnProperty(e)};MediumEditor.extensions.button=e})();(function(){MediumEditor.extensions.button.prototype.defaults={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:true,contentDefault:"<b>B</b>",contentFA:'<i class="fa fa-bold"></i>'},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:true,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="fa fa-italic"></i>'},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:true,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="fa fa-underline"></i>'},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:true,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},html:{name:"html",action:"html",aria:"evaluate html",tagNames:["iframe","object"],contentDefault:"<b>html</b>",contentFA:'<i class="fa fa-code"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:true,contentDefault:"<b>1.</b>",contentFA:'<i class="fa fa-list-ol"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:true,contentDefault:"<b>&bull;</b>",contentFA:'<i class="fa fa-list-ul"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="fa fa-eraser"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},h1:{name:"h1",action:"append-h1",aria:"header type one",tagNames:["h1"],contentDefault:"<b>H1</b>",contentFA:'<i class="fa fa-header"><sup>1</sup>'},h2:{name:"h2",action:"append-h2",aria:"header type two",tagNames:["h2"],contentDefault:"<b>H2</b>",contentFA:'<i class="fa fa-header"><sup>2</sup>'},h3:{name:"h3",action:"append-h3",aria:"header type three",tagNames:["h3"],contentDefault:"<b>H3</b>",contentFA:'<i class="fa fa-header"><sup>3</sup>'},h4:{name:"h4",action:"append-h4",aria:"header type four",tagNames:["h4"],contentDefault:"<b>H4</b>",contentFA:'<i class="fa fa-header"><sup>4</sup>'},h5:{name:"h5",action:"append-h5",aria:"header type five",tagNames:["h5"],contentDefault:"<b>H5</b>",contentFA:'<i class="fa fa-header"><sup>5</sup>'},h6:{name:"h6",action:"append-h6",aria:"header type six",tagNames:["h6"],contentDefault:"<b>H6</b>",contentFA:'<i class="fa fa-header"><sup>6</sup>'}}})();(function(){var e=MediumEditor.extensions.button.extend({init:function(){MediumEditor.extensions.button.prototype.init.apply(this||t,arguments)},formSaveLabel:"&#10003;",formCloseLabel:"&times;",activeClass:"medium-editor-toolbar-form-active",hasForm:true,getForm:function(){},isDisplayed:function(){return!!(this||t).hasForm&&this.getForm().classList.contains((this||t).activeClass)},showForm:function(){(this||t).hasForm&&this.getForm().classList.add((this||t).activeClass)},hideForm:function(){(this||t).hasForm&&this.getForm().classList.remove((this||t).activeClass)},showToolbarDefaultActions:function(){var e=(this||t).base.getExtensionByName("toolbar");e&&e.showToolbarDefaultActions()},hideToolbarDefaultActions:function(){var e=(this||t).base.getExtensionByName("toolbar");e&&e.hideToolbarDefaultActions()},setToolbarPosition:function(){var e=(this||t).base.getExtensionByName("toolbar");e&&e.setToolbarPosition()}});MediumEditor.extensions.form=e})();(function(){var e=MediumEditor.extensions.form.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:false,placeholderText:"Paste or type a link",targetCheckbox:false,targetCheckboxText:"Open in new window",name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>',init:function(){MediumEditor.extensions.form.prototype.init.apply(this||t,arguments);this.subscribe("editableKeydown",(this||t).handleKeydown.bind(this||t))},handleClick:function(e){e.preventDefault();e.stopPropagation();var i=MediumEditor.selection.getSelectionRange((this||t).document);if("a"===i.startContainer.nodeName.toLowerCase()||"a"===i.endContainer.nodeName.toLowerCase()||MediumEditor.util.getClosestTag(MediumEditor.selection.getSelectedParentElement(i),"a"))return this.execAction("unlink");this.isDisplayed()||this.showForm();return false},handleKeydown:function(e){MediumEditor.util.isKey(e,MediumEditor.util.keyCode.K)&&MediumEditor.util.isMetaCtrlKey(e)&&!e.shiftKey&&this.handleClick(e)},getForm:function(){(this||t).form||((this||t).form=this.createForm());return(this||t).form},getTemplate:function(){var e=['<input type="text" class="medium-editor-toolbar-input" placeholder="',(this||t).placeholderText,'">'];e.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':(this||t).formSaveLabel,"</a>");e.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':(this||t).formCloseLabel,"</a>");(this||t).targetCheckbox&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target" id="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">','<label for="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">',(this||t).targetCheckboxText,"</label>","</div>");(this||t).customClassOption&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",(this||t).customClassOptionText,"</label>","</div>");return e.join("")},isDisplayed:function(){return MediumEditor.extensions.form.prototype.isDisplayed.apply(this||t)},hideForm:function(){MediumEditor.extensions.form.prototype.hideForm.apply(this||t);this.getInput().value=""},showForm:function(e){var i=this.getInput(),n=this.getAnchorTargetCheckbox(),o=this.getAnchorButtonCheckbox();e=e||{value:""};"string"===typeof e&&(e={value:e});(this||t).base.saveSelection();this.hideToolbarDefaultActions();MediumEditor.extensions.form.prototype.showForm.apply(this||t);this.setToolbarPosition();i.value=e.value;i.focus();n&&(n.checked="_blank"===e.target);if(o){var r=e.buttonClass?e.buttonClass.split(" "):[];o.checked=-1!==r.indexOf((this||t).customClassOption)}},destroy:function(){if(!(this||t).form)return false;(this||t).form.parentNode&&(this||t).form.parentNode.removeChild((this||t).form);delete(this||t).form},getFormOpts:function(){var e=this.getAnchorTargetCheckbox(),i=this.getAnchorButtonCheckbox(),n={value:this.getInput().value.trim()};(this||t).linkValidation&&(n.value=this.checkLinkFormat(n.value));n.target="_self";e&&e.checked&&(n.target="_blank");i&&i.checked&&(n.buttonClass=(this||t).customClassOption);return n},doFormSave:function(){var e=this.getFormOpts();this.completeFormSave(e)},completeFormSave:function(e){(this||t).base.restoreSelection();this.execAction((this||t).action,e);(this||t).base.checkSelection()},ensureEncodedUri:function(e){return e===decodeURI(e)?encodeURI(e):e},ensureEncodedUriComponent:function(e){return e===decodeURIComponent(e)?encodeURIComponent(e):e},ensureEncodedParam:function(e){var t=e.split("="),i=t[0],n=t[1];return i+(void 0===n?"":"="+this.ensureEncodedUriComponent(n))},ensureEncodedQuery:function(e){return e.split("&").map((this||t).ensureEncodedParam.bind(this||t)).join("&")},checkLinkFormat:function(e){var t=/^([a-z]+:)?\/\/|^(mailto|tel|maps):|^\#/i,i=t.test(e),n="",o=/^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/,r=e.match(/^(.*?)(?:\?(.*?))?(?:#(.*))?$/),s=r[1],a=r[2],l=r[3];if(o.test(e))return"tel:"+e;if(!i){var d=s.split("/")[0];(d.match(/.+(\.|:).+/)||"localhost"===d)&&(n="http://")}return n+this.ensureEncodedUri(s)+(void 0===a?"":"?"+this.ensureEncodedQuery(a))+(void 0===l?"":"#"+l)},doFormCancel:function(){(this||t).base.restoreSelection();(this||t).base.checkSelection()},attachFormEvents:function(e){var i=e.querySelector(".medium-editor-toolbar-close"),n=e.querySelector(".medium-editor-toolbar-save"),o=e.querySelector(".medium-editor-toolbar-input");this.on(e,"click",(this||t).handleFormClick.bind(this||t));this.on(o,"keyup",(this||t).handleTextboxKeyup.bind(this||t));this.on(i,"click",(this||t).handleCloseClick.bind(this||t));this.on(n,"click",(this||t).handleSaveClick.bind(this||t),true)},createForm:function(){var e=(this||t).document,i=e.createElement("div");i.className="medium-editor-toolbar-form";i.id="medium-editor-toolbar-form-anchor-"+this.getEditorId();i.innerHTML=this.getTemplate();this.attachFormEvents(i);return i},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(e){if(e.keyCode!==MediumEditor.util.keyCode.ENTER){if(e.keyCode===MediumEditor.util.keyCode.ESCAPE){e.preventDefault();this.doFormCancel()}}else{e.preventDefault();this.doFormSave()}},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault();this.doFormSave()},handleCloseClick:function(e){e.preventDefault();this.doFormCancel()}});MediumEditor.extensions.anchor=e})();(function(){var e=MediumEditor.Extension.extend({name:"anchor-preview",hideDelay:500,previewValueSelector:"a",showWhenToolbarIsVisible:false,showOnEmptyLinks:true,init:function(){(this||t).anchorPreview=this.createPreview();this.getEditorOption("elementsContainer").appendChild((this||t).anchorPreview);this.attachToEditables()},getInteractionElements:function(){return this.getPreviewElement()},getPreviewElement:function(){return(this||t).anchorPreview},createPreview:function(){var e=(this||t).document.createElement("div");e.id="medium-editor-anchor-preview-"+this.getEditorId();e.className="medium-editor-anchor-preview";e.innerHTML=this.getTemplate();this.on(e,"click",(this||t).handleClick.bind(this||t));return e},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">'+'    <a class="medium-editor-toolbar-anchor-preview-inner"></a>'+"</div>"},destroy:function(){if((this||t).anchorPreview){(this||t).anchorPreview.parentNode&&(this||t).anchorPreview.parentNode.removeChild((this||t).anchorPreview);delete(this||t).anchorPreview}},hidePreview:function(){(this||t).anchorPreview&&(this||t).anchorPreview.classList.remove("medium-editor-anchor-preview-active");(this||t).activeAnchor=null},showPreview:function(e){if((this||t).anchorPreview.classList.contains("medium-editor-anchor-preview-active")||e.getAttribute("data-disable-preview"))return true;if((this||t).previewValueSelector){(this||t).anchorPreview.querySelector((this||t).previewValueSelector).textContent=e.attributes.href.value;(this||t).anchorPreview.querySelector((this||t).previewValueSelector).href=e.attributes.href.value}(this||t).anchorPreview.classList.add("medium-toolbar-arrow-over");(this||t).anchorPreview.classList.remove("medium-toolbar-arrow-under");(this||t).anchorPreview.classList.contains("medium-editor-anchor-preview-active")||(this||t).anchorPreview.classList.add("medium-editor-anchor-preview-active");(this||t).activeAnchor=e;this.positionPreview();this.attachPreviewHandlers();return this||t},positionPreview:function(e){e=e||(this||t).activeAnchor;var i=(this||t).window.innerWidth,n=(this||t).anchorPreview.offsetHeight,o=e.getBoundingClientRect(),r=(this||t).diffLeft,s=(this||t).diffTop,a=this.getEditorOption("elementsContainer"),l=["absolute","fixed"].indexOf(window.getComputedStyle(a).getPropertyValue("position"))>-1,d={},u,c,h,m,f;u=(this||t).anchorPreview.offsetWidth/2;var p=(this||t).base.getExtensionByName("toolbar");if(p){r=p.diffLeft;s=p.diffTop}c=r-u;if(l){m=a.getBoundingClientRect();["top","left"].forEach((function(e){d[e]=o[e]-m[e]}));d.width=o.width;d.height=o.height;o=d;i=m.width;f=a.scrollTop}else f=(this||t).window.pageYOffset;h=o.left+o.width/2;f+=n+o.top+o.height-s-(this||t).anchorPreview.offsetHeight;(this||t).anchorPreview.style.top=Math.round(f)+"px";(this||t).anchorPreview.style.right="initial";if(h<u){(this||t).anchorPreview.style.left=c+u+"px";(this||t).anchorPreview.style.right="initial"}else if(i-h<u){(this||t).anchorPreview.style.left="auto";(this||t).anchorPreview.style.right=0}else{(this||t).anchorPreview.style.left=c+h+"px";(this||t).anchorPreview.style.right="initial"}},attachToEditables:function(){this.subscribe("editableMouseover",(this||t).handleEditableMouseover.bind(this||t));this.subscribe("positionedToolbar",(this||t).handlePositionedToolbar.bind(this||t))},handlePositionedToolbar:function(){(this||t).showWhenToolbarIsVisible||this.hidePreview()},handleClick:function(e){var i=(this||t).base.getExtensionByName("anchor"),n=(this||t).activeAnchor;if(i&&n){e.preventDefault();(this||t).base.selectElement((this||t).activeAnchor);(this||t).base.delay(function(){if(n){var e={value:n.attributes.href.value,target:n.getAttribute("target"),buttonClass:n.getAttribute("class")};i.showForm(e);n=null}}.bind(this||t))}this.hidePreview()},handleAnchorMouseout:function(){(this||t).anchorToPreview=null;this.off((this||t).activeAnchor,"mouseout",(this||t).instanceHandleAnchorMouseout);(this||t).instanceHandleAnchorMouseout=null},handleEditableMouseover:function(e){var i=MediumEditor.util.getClosestTag(e.target,"a");if(false!==i){if(!(this||t).showOnEmptyLinks&&(!/href=["']\S+["']/.test(i.outerHTML)||/href=["']#\S+["']/.test(i.outerHTML)))return true;var n=(this||t).base.getExtensionByName("toolbar");if(!(this||t).showWhenToolbarIsVisible&&n&&n.isDisplayed&&n.isDisplayed())return true;(this||t).activeAnchor&&(this||t).activeAnchor!==i&&this.detachPreviewHandlers();(this||t).anchorToPreview=i;(this||t).instanceHandleAnchorMouseout=(this||t).handleAnchorMouseout.bind(this||t);this.on((this||t).anchorToPreview,"mouseout",(this||t).instanceHandleAnchorMouseout);(this||t).base.delay(function(){(this||t).anchorToPreview&&this.showPreview((this||t).anchorToPreview)}.bind(this||t))}},handlePreviewMouseover:function(){(this||t).lastOver=(new Date).getTime();(this||t).hovering=true},handlePreviewMouseout:function(e){e.relatedTarget&&/anchor-preview/.test(e.relatedTarget.className)||((this||t).hovering=false)},updatePreview:function(){if((this||t).hovering)return true;var e=(new Date).getTime()-(this||t).lastOver;e>(this||t).hideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval((this||t).intervalTimer);if((this||t).instanceHandlePreviewMouseover){this.off((this||t).anchorPreview,"mouseover",(this||t).instanceHandlePreviewMouseover);this.off((this||t).anchorPreview,"mouseout",(this||t).instanceHandlePreviewMouseout);if((this||t).activeAnchor){this.off((this||t).activeAnchor,"mouseover",(this||t).instanceHandlePreviewMouseover);this.off((this||t).activeAnchor,"mouseout",(this||t).instanceHandlePreviewMouseout)}}this.hidePreview();(this||t).hovering=(this||t).instanceHandlePreviewMouseover=(this||t).instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){(this||t).lastOver=(new Date).getTime();(this||t).hovering=true;(this||t).instanceHandlePreviewMouseover=(this||t).handlePreviewMouseover.bind(this||t);(this||t).instanceHandlePreviewMouseout=(this||t).handlePreviewMouseout.bind(this||t);(this||t).intervalTimer=setInterval((this||t).updatePreview.bind(this||t),200);this.on((this||t).anchorPreview,"mouseover",(this||t).instanceHandlePreviewMouseover);this.on((this||t).anchorPreview,"mouseout",(this||t).instanceHandlePreviewMouseout);this.on((this||t).activeAnchor,"mouseover",(this||t).instanceHandlePreviewMouseover);this.on((this||t).activeAnchor,"mouseout",(this||t).instanceHandlePreviewMouseout)}});MediumEditor.extensions.anchorPreview=e})();(function(){var e,i,n,o,r;e=[" ","\t","\n","\r","","","","","","\u2028","\u2029"];i="com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|"+"xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|"+"bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|"+"fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|"+"is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|"+"mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|"+"pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|"+"tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw";n="("+"((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.]("+i+")\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?]))"+")|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.("+i+"))";o=new RegExp("^("+i+")$","i");r=new RegExp(n,"gi");function nodeIsNotInsideAnchorTag(e){return!MediumEditor.util.getClosestTag(e,"a")}var s=MediumEditor.Extension.extend({init:function(){MediumEditor.Extension.prototype.init.apply(this||t,arguments);(this||t).disableEventHandling=false;this.subscribe("editableKeypress",(this||t).onKeypress.bind(this||t));this.subscribe("editableBlur",(this||t).onBlur.bind(this||t));(this||t).document.execCommand("AutoUrlDetect",false,false)},isLastInstance:function(){var e=0;for(var i=0;i<(this||t).window._mediumEditors.length;i++){var n=(this||t).window._mediumEditors[i];null!==n&&void 0!==n.getExtensionByName("autoLink")&&e++}return 1===e},destroy:function(){(this||t).document.queryCommandSupported("AutoUrlDetect")&&this.isLastInstance()&&(this||t).document.execCommand("AutoUrlDetect",false,true)},onBlur:function(e,t){this.performLinking(t)},onKeypress:function(e){if(!(this||t).disableEventHandling&&MediumEditor.util.isKey(e,[MediumEditor.util.keyCode.SPACE,MediumEditor.util.keyCode.ENTER])){clearTimeout((this||t).performLinkingTimeout);(this||t).performLinkingTimeout=setTimeout(function(){try{var i=(this||t).base.exportSelection();this.performLinking(e.target)&&(this||t).base.importSelection(i,true)}catch(e){window.console&&window.console.error("Failed to perform linking",e);(this||t).disableEventHandling=true}}.bind(this||t),0)}},performLinking:function(e){var i=MediumEditor.util.splitByBlockElements(e),n=false;0===i.length&&(i=[e]);for(var o=0;o<i.length;o++){n=this.removeObsoleteAutoLinkSpans(i[o])||n;n=this.performLinkingWithinElement(i[o])||n}(this||t).base.events.updateInput(e,{target:e,currentTarget:e});return n},removeObsoleteAutoLinkSpans:function(e){if(!e||3===e.nodeType)return false;var i=e.querySelectorAll('span[data-auto-link="true"]'),n=false;for(var o=0;o<i.length;o++){var r=i[o].textContent;-1===r.indexOf("://")&&(r=MediumEditor.util.ensureUrlHasProtocol(r));if(i[o].getAttribute("data-href")!==r&&nodeIsNotInsideAnchorTag(i[o])){n=true;var s=r.replace(/\s+$/,"");if(i[o].getAttribute("data-href")===s){var a=r.length-s.length,l=MediumEditor.util.splitOffDOMTree(i[o],this.splitTextBeforeEnd(i[o],a));i[o].parentNode.insertBefore(l,i[o].nextSibling)}else MediumEditor.util.unwrap(i[o],(this||t).document)}}return n},splitTextBeforeEnd:function(e,i){var n=(this||t).document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,false),o=true;while(o)o=null!==n.lastChild();var r,s,a;while(i>0&&null!==a){r=n.currentNode;s=r.nodeValue;if(s.length>i){a=r.splitText(s.length-i);i=0}else{a=n.previousNode();i-=s.length}}return a},performLinkingWithinElement:function(e){var i=this.findLinkableText(e),n=false;for(var o=0;o<i.length;o++){var r=MediumEditor.util.findOrCreateMatchingTextNodes((this||t).document,e,i[o]);this.shouldNotLink(r)||this.createAutoLink(r,i[o].href)}return n},shouldNotLink:function(e){var t=false;for(var i=0;i<e.length&&false===t;i++)t=!!MediumEditor.util.traverseUp(e[i],(function(e){return"a"===e.nodeName.toLowerCase()||e.getAttribute&&"true"===e.getAttribute("data-auto-link")}));return t},findLinkableText:function(t){var i=t.textContent,n=null,s=[];while(null!==(n=r.exec(i))){var a=true,l=n.index+n[0].length;a=(0===n.index||-1!==e.indexOf(i[n.index-1]))&&(l===i.length||-1!==e.indexOf(i[l]));a=a&&(-1!==n[0].indexOf("/")||o.test(n[0].split(".").pop().split("?").shift()));a&&s.push({href:n[0],start:n.index,end:l})}return s},createAutoLink:function(e,i){i=MediumEditor.util.ensureUrlHasProtocol(i);var n=MediumEditor.util.createLink((this||t).document,e,i,this.getEditorOption("targetBlank")?"_blank":null),o=(this||t).document.createElement("span");o.setAttribute("data-auto-link","true");o.setAttribute("data-href",i);n.insertBefore(o,n.firstChild);while(n.childNodes.length>1)o.appendChild(n.childNodes[1])}});MediumEditor.extensions.autoLink=s})();(function(){var e="medium-editor-dragover";function clearClassNames(t){var i=MediumEditor.util.getContainerEditorElement(t),n=Array.prototype.slice.call(i.parentElement.querySelectorAll("."+e));n.forEach((function(t){t.classList.remove(e)}))}var i=MediumEditor.Extension.extend({name:"fileDragging",allowedTypes:["image"],init:function(){MediumEditor.Extension.prototype.init.apply(this||t,arguments);this.subscribe("editableDrag",(this||t).handleDrag.bind(this||t));this.subscribe("editableDrop",(this||t).handleDrop.bind(this||t))},handleDrag:function(t){t.preventDefault();t.dataTransfer.dropEffect="copy";var i=t.target.classList?t.target:t.target.parentElement;clearClassNames(i);"dragover"===t.type&&i.classList.add(e)},handleDrop:function(e){e.preventDefault();e.stopPropagation();(this||t).base.selectElement(e.target);var i=(this||t).base.exportSelection();i.start=i.end;(this||t).base.importSelection(i);e.dataTransfer.files&&Array.prototype.slice.call(e.dataTransfer.files).forEach((function(e){this.isAllowedFile(e)&&e.type.match("image")&&this.insertImageFile(e)}),this||t);clearClassNames(e.target)},isAllowedFile:function(e){return(this||t).allowedTypes.some((function(t){return!!e.type.match(t)}))},insertImageFile:function(e){if("function"===typeof FileReader){var i=new FileReader;i.readAsDataURL(e);i.addEventListener("load",function(e){var i=(this||t).document.createElement("img");i.src=e.target.result;MediumEditor.util.insertHTMLCommand((this||t).document,i.outerHTML)}.bind(this||t))}}});MediumEditor.extensions.fileDragging=i})();(function(){var e=MediumEditor.Extension.extend({name:"keyboard-commands",commands:[{command:"bold",key:"B",meta:true,shift:false,alt:false},{command:"italic",key:"I",meta:true,shift:false,alt:false},{command:"underline",key:"U",meta:true,shift:false,alt:false}],init:function(){MediumEditor.Extension.prototype.init.apply(this||t,arguments);this.subscribe("editableKeydown",(this||t).handleKeydown.bind(this||t));(this||t).keys={};(this||t).commands.forEach((function(e){var i=e.key.charCodeAt(0);(this||t).keys[i]||((this||t).keys[i]=[]);(this||t).keys[i].push(e)}),this||t)},handleKeydown:function(e){var i=MediumEditor.util.getKeyCode(e);if((this||t).keys[i]){var n=MediumEditor.util.isMetaCtrlKey(e),o=!!e.shiftKey,r=!!e.altKey;(this||t).keys[i].forEach((function(i){if(i.meta===n&&i.shift===o&&(i.alt===r||void 0===i.alt)){e.preventDefault();e.stopPropagation();"function"===typeof i.command?i.command.apply(this||t):false!==i.command&&this.execAction(i.command)}}),this||t)}}});MediumEditor.extensions.keyboardCommands=e})();(function(){var e=MediumEditor.extensions.form.extend({name:"fontname",action:"fontName",aria:"change font name",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-font"></i>',fonts:["","Arial","Verdana","Times New Roman"],init:function(){MediumEditor.extensions.form.prototype.init.apply(this||t,arguments)},handleClick:function(e){e.preventDefault();e.stopPropagation();if(!this.isDisplayed()){var i=(this||t).document.queryCommandValue("fontName")+"";this.showForm(i)}return false},getForm:function(){(this||t).form||((this||t).form=this.createForm());return(this||t).form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none";this.getSelect().value=""},showForm:function(e){var i=this.getSelect();(this||t).base.saveSelection();this.hideToolbarDefaultActions();this.getForm().style.display="block";this.setToolbarPosition();i.value=e||"";i.focus()},destroy:function(){if(!(this||t).form)return false;(this||t).form.parentNode&&(this||t).form.parentNode.removeChild((this||t).form);delete(this||t).form},doFormSave:function(){(this||t).base.restoreSelection();(this||t).base.checkSelection()},doFormCancel:function(){(this||t).base.restoreSelection();this.clearFontName();(this||t).base.checkSelection()},createForm:function(){var e=(this||t).document,i=e.createElement("div"),n=e.createElement("select"),o=e.createElement("a"),r=e.createElement("a"),s;i.className="medium-editor-toolbar-form";i.id="medium-editor-toolbar-form-fontname-"+this.getEditorId();this.on(i,"click",(this||t).handleFormClick.bind(this||t));for(var a=0;a<(this||t).fonts.length;a++){s=e.createElement("option");s.innerHTML=(this||t).fonts[a];s.value=(this||t).fonts[a];n.appendChild(s)}n.className="medium-editor-toolbar-select";i.appendChild(n);this.on(n,"change",(this||t).handleFontChange.bind(this||t));r.setAttribute("href","#");r.className="medium-editor-toobar-save";r.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;";i.appendChild(r);this.on(r,"click",(this||t).handleSaveClick.bind(this||t),true);o.setAttribute("href","#");o.className="medium-editor-toobar-close";o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;";i.appendChild(o);this.on(o,"click",(this||t).handleCloseClick.bind(this||t));return i},getSelect:function(){return this.getForm().querySelector("select.medium-editor-toolbar-select")},clearFontName:function(){MediumEditor.selection.getSelectedElements((this||t).document).forEach((function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("face")&&e.removeAttribute("face")}))},handleFontChange:function(){var e=this.getSelect().value;""===e?this.clearFontName():this.execAction("fontName",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault();this.doFormSave()},handleCloseClick:function(e){e.preventDefault();this.doFormCancel()}});MediumEditor.extensions.fontName=e})();(function(){var e=MediumEditor.extensions.form.extend({name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>',init:function(){MediumEditor.extensions.form.prototype.init.apply(this||t,arguments)},handleClick:function(e){e.preventDefault();e.stopPropagation();if(!this.isDisplayed()){var i=(this||t).document.queryCommandValue("fontSize")+"";this.showForm(i)}return false},getForm:function(){(this||t).form||((this||t).form=this.createForm());return(this||t).form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none";this.getInput().value=""},showForm:function(e){var i=this.getInput();(this||t).base.saveSelection();this.hideToolbarDefaultActions();this.getForm().style.display="block";this.setToolbarPosition();i.value=e||"";i.focus()},destroy:function(){if(!(this||t).form)return false;(this||t).form.parentNode&&(this||t).form.parentNode.removeChild((this||t).form);delete(this||t).form},doFormSave:function(){(this||t).base.restoreSelection();(this||t).base.checkSelection()},doFormCancel:function(){(this||t).base.restoreSelection();this.clearFontSize();(this||t).base.checkSelection()},createForm:function(){var e=(this||t).document,i=e.createElement("div"),n=e.createElement("input"),o=e.createElement("a"),r=e.createElement("a");i.className="medium-editor-toolbar-form";i.id="medium-editor-toolbar-form-fontsize-"+this.getEditorId();this.on(i,"click",(this||t).handleFormClick.bind(this||t));n.setAttribute("type","range");n.setAttribute("min","1");n.setAttribute("max","7");n.className="medium-editor-toolbar-input";i.appendChild(n);this.on(n,"change",(this||t).handleSliderChange.bind(this||t));r.setAttribute("href","#");r.className="medium-editor-toobar-save";r.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;";i.appendChild(r);this.on(r,"click",(this||t).handleSaveClick.bind(this||t),true);o.setAttribute("href","#");o.className="medium-editor-toobar-close";o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;";i.appendChild(o);this.on(o,"click",(this||t).handleCloseClick.bind(this||t));return i},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){MediumEditor.selection.getSelectedElements((this||t).document).forEach((function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("size")&&e.removeAttribute("size")}))},handleSliderChange:function(){var e=this.getInput().value;"4"===e?this.clearFontSize():this.execAction("fontSize",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault();this.doFormSave()},handleCloseClick:function(e){e.preventDefault();this.doFormCancel()}});MediumEditor.extensions.fontSize=e})();(function(){var e="%ME_PASTEBIN%",i=null,n=null,stopProp=function(e){e.stopPropagation()};function createReplacements(){return[[new RegExp(/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g),""],[new RegExp(/<!--StartFragment-->|<!--EndFragment-->/g),""],[new RegExp(/<br>$/i),""],[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:(bold|700)|font-weight:(bold|700);font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:(bold|700)[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"||)(((?!&quot;|&rdquo;|&ldquo;|"||).)*)(?:&quot;|&rdquo;|&ldquo;|"||)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""],[new RegExp(/<!\[if !supportLists\]>(((?!<!).)*)<!\[endif]\>/gi),"$1"]]}function getClipboardContent(e,t,i){var n=e.clipboardData||t.clipboardData||i.dataTransfer,o={};if(!n)return o;if(n.getData){var r=n.getData("Text");r&&r.length>0&&(o["text/plain"]=r)}if(n.types)for(var s=0;s<n.types.length;s++){var a=n.types[s];o[a]=n.getData(a)}return o}var o=MediumEditor.Extension.extend({forcePlainText:true,cleanPastedHTML:false,preCleanReplacements:[],cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],unwrapTags:[],init:function(){MediumEditor.Extension.prototype.init.apply(this||t,arguments);if((this||t).forcePlainText||(this||t).cleanPastedHTML){this.subscribe("editableKeydown",(this||t).handleKeydown.bind(this||t));this.getEditorElements().forEach((function(e){this.on(e,"paste",(this||t).handlePaste.bind(this||t))}),this||t);this.subscribe("addElement",(this||t).handleAddElement.bind(this||t))}},handleAddElement:function(e,i){this.on(i,"paste",(this||t).handlePaste.bind(this||t))},destroy:function(){((this||t).forcePlainText||(this||t).cleanPastedHTML)&&this.removePasteBin()},handlePaste:function(e,i){if(!e.defaultPrevented){var n=getClipboardContent(e,(this||t).window,(this||t).document),o=n["text/html"],r=n["text/plain"];(this||t).window.clipboardData&&void 0===e.clipboardData&&!o&&(o=r);if(o||r){e.preventDefault();this.doPaste(o,r,i)}}},doPaste:function(e,i,n){var o,r="",s;if((this||t).cleanPastedHTML&&e)return this.cleanPaste(e);if(i){if(this.getEditorOption("disableReturn")||n&&n.getAttribute("data-disable-return"))r=MediumEditor.util.htmlEntities(i);else{o=i.split(/[\r\n]+/g);if(o.length>1)for(s=0;s<o.length;s+=1)""!==o[s]&&(r+="<p>"+MediumEditor.util.htmlEntities(o[s])+"</p>");else r=MediumEditor.util.htmlEntities(o[0])}MediumEditor.util.insertHTMLCommand((this||t).document,r)}},handlePasteBinPaste:function(e){if(e.defaultPrevented)this.removePasteBin();else{var i=getClipboardContent(e,(this||t).window,(this||t).document),o=i["text/html"],r=i["text/plain"],s=n;if((this||t).cleanPastedHTML&&!o)setTimeout(function(){(this||t).cleanPastedHTML&&(o=this.getPasteBinHtml());this.removePasteBin();this.doPaste(o,r,s);this.trigger("editablePaste",{currentTarget:s,target:s},s)}.bind(this||t),0);else{e.preventDefault();this.removePasteBin();this.doPaste(o,r,s);this.trigger("editablePaste",{currentTarget:s,target:s},s)}}},handleKeydown:function(e,t){if(MediumEditor.util.isKey(e,MediumEditor.util.keyCode.V)&&MediumEditor.util.isMetaCtrlKey(e)){e.stopImmediatePropagation();this.removePasteBin();this.createPasteBin(t)}},createPasteBin:function(o){var r,s=MediumEditor.selection.getSelectionRange((this||t).document),a=(this||t).window.pageYOffset;n=o;if(s){r=s.getClientRects();r.length?a+=r[0].top:void 0!==s.startContainer.getBoundingClientRect?a+=s.startContainer.getBoundingClientRect().top:a+=s.getBoundingClientRect().top}i=s;var l=(this||t).document.createElement("div");l.id=(this||t).pasteBinId="medium-editor-pastebin-"+ +Date.now();l.setAttribute("style","border: 1px red solid; position: absolute; top: "+a+"px; width: 10px; height: 10px; overflow: hidden; opacity: 0");l.setAttribute("contentEditable",true);l.innerHTML=e;(this||t).document.body.appendChild(l);this.on(l,"focus",stopProp);this.on(l,"focusin",stopProp);this.on(l,"focusout",stopProp);l.focus();MediumEditor.selection.selectNode(l,(this||t).document);(this||t).boundHandlePaste||((this||t).boundHandlePaste=(this||t).handlePasteBinPaste.bind(this||t));this.on(l,"paste",(this||t).boundHandlePaste)},removePasteBin:function(){if(null!==i){MediumEditor.selection.selectRange((this||t).document,i);i=null}null!==n&&(n=null);var e=this.getPasteBin();if(e&&e){this.off(e,"focus",stopProp);this.off(e,"focusin",stopProp);this.off(e,"focusout",stopProp);this.off(e,"paste",(this||t).boundHandlePaste);e.parentElement.removeChild(e)}},getPasteBin:function(){return(this||t).document.getElementById((this||t).pasteBinId)},getPasteBinHtml:function(){var t=this.getPasteBin();if(!t)return false;if(t.firstChild&&"mcepastebin"===t.firstChild.id)return false;var i=t.innerHTML;return!(!i||i===e)&&i},cleanPaste:function(e){var i,n,o,r,s=/<p|<br|<div/.test(e),a=[].concat((this||t).preCleanReplacements||[],createReplacements(),(this||t).cleanReplacements||[]);for(i=0;i<a.length;i+=1)e=e.replace(a[i][0],a[i][1]);if(!s)return this.pasteHTML(e);o=(this||t).document.createElement("div");o.innerHTML="<p>"+e.split("<br><br>").join("</p><p>")+"</p>";n=o.querySelectorAll("a,p,div,br");for(i=0;i<n.length;i+=1){r=n[i];r.innerHTML=r.innerHTML.replace(/\n/gi," ");switch(r.nodeName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(r);break;case"br":this.filterLineBreak(r);break}}this.pasteHTML(o.innerHTML)},pasteHTML:function(e,i){i=MediumEditor.util.defaults({},i,{cleanAttrs:(this||t).cleanAttrs,cleanTags:(this||t).cleanTags,unwrapTags:(this||t).unwrapTags});var n,o,r,s,a=(this||t).document.createDocumentFragment();a.appendChild((this||t).document.createElement("body"));s=a.querySelector("body");s.innerHTML=e;this.cleanupSpans(s);n=s.querySelectorAll("*");for(r=0;r<n.length;r+=1){o=n[r];"a"===o.nodeName.toLowerCase()&&this.getEditorOption("targetBlank")&&MediumEditor.util.setTargetBlank(o);MediumEditor.util.cleanupAttrs(o,i.cleanAttrs);MediumEditor.util.cleanupTags(o,i.cleanTags);MediumEditor.util.unwrapTags(o,i.unwrapTags)}MediumEditor.util.insertHTMLCommand((this||t).document,s.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(e){return e&&("p"===e.nodeName.toLowerCase()||"div"===e.nodeName.toLowerCase())},filterCommonBlocks:function(e){/^\s*$/.test(e.textContent)&&e.parentNode&&e.parentNode.removeChild(e)},filterLineBreak:function(e){this.isCommonBlock(e.previousElementSibling)?this.removeWithParent(e):!this.isCommonBlock(e.parentNode)||e.parentNode.firstChild!==e&&e.parentNode.lastChild!==e?e.parentNode&&1===e.parentNode.childElementCount&&""===e.parentNode.textContent&&this.removeWithParent(e):this.removeWithParent(e)},removeWithParent:function(e){e&&e.parentNode&&(e.parentNode.parentNode&&1===e.parentNode.childElementCount?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e))},cleanupSpans:function(e){var i,n,o,r=e.querySelectorAll(".replace-with"),isCEF=function(e){return e&&"#text"!==e.nodeName&&"false"===e.getAttribute("contenteditable")};for(i=0;i<r.length;i+=1){n=r[i];o=(this||t).document.createElement(n.classList.contains("bold")?"b":"i");n.classList.contains("bold")&&n.classList.contains("italic")?o.innerHTML="<i>"+n.innerHTML+"</i>":o.innerHTML=n.innerHTML;n.parentNode.replaceChild(o,n)}r=e.querySelectorAll("span");for(i=0;i<r.length;i+=1){n=r[i];if(MediumEditor.util.traverseUp(n,isCEF))return false;MediumEditor.util.unwrap(n,(this||t).document)}}});MediumEditor.extensions.paste=o})();(function(){var e=MediumEditor.Extension.extend({name:"placeholder",text:"Type your text",hideOnClick:true,init:function(){MediumEditor.Extension.prototype.init.apply(this||t,arguments);this.initPlaceholders();this.attachEventHandlers()},initPlaceholders:function(){this.getEditorElements().forEach((this||t).initElement,this||t)},handleAddElement:function(e,t){this.initElement(t)},initElement:function(e){e.getAttribute("data-placeholder")||e.setAttribute("data-placeholder",(this||t).text);this.updatePlaceholder(e)},destroy:function(){this.getEditorElements().forEach((this||t).cleanupElement,this||t)},handleRemoveElement:function(e,t){this.cleanupElement(t)},cleanupElement:function(e){e.getAttribute("data-placeholder")===(this||t).text&&e.removeAttribute("data-placeholder")},showPlaceholder:function(e){if(e)if(MediumEditor.util.isFF&&0===e.childNodes.length){e.classList.add("medium-editor-placeholder-relative");e.classList.remove("medium-editor-placeholder")}else{e.classList.add("medium-editor-placeholder");e.classList.remove("medium-editor-placeholder-relative")}},hidePlaceholder:function(e){if(e){e.classList.remove("medium-editor-placeholder");e.classList.remove("medium-editor-placeholder-relative")}},updatePlaceholder:function(e,t){if(e.querySelector("img, blockquote, ul, ol, table")||""!==e.textContent.replace(/^\s+|\s+$/g,""))return this.hidePlaceholder(e);t||this.showPlaceholder(e)},attachEventHandlers:function(){(this||t).hideOnClick&&this.subscribe("focus",(this||t).handleFocus.bind(this||t));this.subscribe("editableInput",(this||t).handleInput.bind(this||t));this.subscribe("blur",(this||t).handleBlur.bind(this||t));this.subscribe("addElement",(this||t).handleAddElement.bind(this||t));this.subscribe("removeElement",(this||t).handleRemoveElement.bind(this||t))},handleInput:function(e,i){var n=(this||t).hideOnClick&&i===(this||t).base.getFocusedElement();this.updatePlaceholder(i,n)},handleFocus:function(e,t){this.hidePlaceholder(t)},handleBlur:function(e,t){this.updatePlaceholder(t)}});MediumEditor.extensions.placeholder=e})();(function(){var e=MediumEditor.Extension.extend({name:"toolbar",align:"center",allowMultiParagraphSelection:true,buttons:["bold","italic","underline","anchor","h2","h3","quote"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:false,static:false,sticky:false,stickyTopOffset:0,updateOnEmptySelection:false,relativeContainer:null,init:function(){MediumEditor.Extension.prototype.init.apply(this||t,arguments);this.initThrottledMethods();(this||t).relativeContainer?(this||t).relativeContainer.appendChild(this.getToolbarElement()):this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement())},forEachExtension:function(e,i){return(this||t).base.extensions.forEach((function(n){if(n!==(this||t))return e.apply(i||this||t,arguments)}),this||t)},createToolbar:function(){var e=(this||t).document.createElement("div");e.id="medium-editor-toolbar-"+this.getEditorId();e.className="medium-editor-toolbar";(this||t).static?e.className+=" static-toolbar":(this||t).relativeContainer?e.className+=" medium-editor-relative-toolbar":e.className+=" medium-editor-stalker-toolbar";e.appendChild(this.createToolbarButtons());this.forEachExtension((function(t){t.hasForm&&e.appendChild(t.getForm())}));this.attachEventHandlers();return e},createToolbarButtons:function(){var e=(this||t).document.createElement("ul"),i,n,o,r,s,a;e.id="medium-editor-toolbar-actions"+this.getEditorId();e.className="medium-editor-toolbar-actions";e.style.display="block";(this||t).buttons.forEach((function(o){if("string"===typeof o){s=o;a=null}else{s=o.name;a=o}r=(this||t).base.addBuiltInExtension(s,a);if(r&&"function"===typeof r.getButton){n=r.getButton((this||t).base);i=(this||t).document.createElement("li");MediumEditor.util.isElement(n)?i.appendChild(n):i.innerHTML=n;e.appendChild(i)}}),this||t);o=e.querySelectorAll("button");if(o.length>0){o[0].classList.add((this||t).firstButtonClass);o[o.length-1].classList.add((this||t).lastButtonClass)}return e},destroy:function(){if((this||t).toolbar){(this||t).toolbar.parentNode&&(this||t).toolbar.parentNode.removeChild((this||t).toolbar);delete(this||t).toolbar}},getInteractionElements:function(){return this.getToolbarElement()},getToolbarElement:function(){(this||t).toolbar||((this||t).toolbar=this.createToolbar());return(this||t).toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){(this||t).throttledPositionToolbar=MediumEditor.util.throttle(function(){(this||t).base.isActive&&this.positionToolbarIfShown()}.bind(this||t))},attachEventHandlers:function(){this.subscribe("blur",(this||t).handleBlur.bind(this||t));this.subscribe("focus",(this||t).handleFocus.bind(this||t));this.subscribe("editableClick",(this||t).handleEditableClick.bind(this||t));this.subscribe("editableKeyup",(this||t).handleEditableKeyup.bind(this||t));this.on((this||t).document.documentElement,"mouseup",(this||t).handleDocumentMouseup.bind(this||t));(this||t).static&&(this||t).sticky&&this.on((this||t).window,"scroll",(this||t).handleWindowScroll.bind(this||t),true);this.on((this||t).window,"resize",(this||t).handleWindowResize.bind(this||t))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(e){if(e&&e.target&&MediumEditor.util.isDescendant(this.getToolbarElement(),e.target))return false;this.checkState()},handleEditableClick:function(){setTimeout(function(){this.checkState()}.bind(this||t),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout((this||t).hideTimeout);clearTimeout((this||t).delayShowTimeout);(this||t).hideTimeout=setTimeout(function(){this.hideToolbar()}.bind(this||t),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout((this||t).hideTimeout);if(!this.isDisplayed()){this.getToolbarElement().classList.add("medium-editor-toolbar-active");this.trigger("showToolbar",{},(this||t).base.getFocusedElement())}},hideToolbar:function(){if(this.isDisplayed()){this.getToolbarElement().classList.remove("medium-editor-toolbar-active");this.trigger("hideToolbar",{},(this||t).base.getFocusedElement())}},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms();this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block");(this||t).delayShowTimeout=(this||t).base.delay(function(){this.showToolbar()}.bind(this||t))},hideExtensionForms:function(){this.forEachExtension((function(e){e.hasForm&&e.isDisplayed()&&e.hideForm()}))},multipleBlockElementsSelected:function(){var e=/<[^\/>][^>]*><\/[^>]+>/gim,i=new RegExp("<("+MediumEditor.util.blockContainerElementNames.join("|")+")[^>]*>","g"),n=MediumEditor.selection.getSelectionHtml((this||t).document).replace(e,""),o=n.match(i);return!!o&&o.length>1},modifySelection:function(){var e=(this||t).window.getSelection(),i=e.getRangeAt(0);if((this||t).standardizeSelectionStart&&i.startContainer.nodeValue&&i.startOffset===i.startContainer.nodeValue.length){var n=MediumEditor.util.findAdjacentTextNodeWithContent(MediumEditor.selection.getSelectionElement((this||t).window),i.startContainer,(this||t).document);if(n){var o=0;while(0===n.nodeValue.substr(o,1).trim().length)o+=1;i=MediumEditor.selection.select((this||t).document,n,o,i.endContainer,i.endOffset)}}},checkState:function(){if(!(this||t).base.preventSelectionUpdates){if(!(this||t).base.getFocusedElement()||MediumEditor.selection.selectionInContentEditableFalse((this||t).window))return this.hideToolbar();var e=MediumEditor.selection.getSelectionElement((this||t).window);if(!e||-1===this.getEditorElements().indexOf(e)||e.getAttribute("data-disable-toolbar"))return this.hideToolbar();if((this||t).updateOnEmptySelection&&(this||t).static)return this.showAndUpdateToolbar();if(!MediumEditor.selection.selectionContainsContent((this||t).document)||false===(this||t).allowMultiParagraphSelection&&this.multipleBlockElementsSelected())return this.hideToolbar();this.showAndUpdateToolbar()}},showAndUpdateToolbar:function(){this.modifySelection();this.setToolbarButtonStates();this.trigger("positionToolbar",{},(this||t).base.getFocusedElement());this.showToolbarDefaultActions();this.setToolbarPosition()},setToolbarButtonStates:function(){this.forEachExtension((function(e){"function"===typeof e.isActive&&"function"===typeof e.setInactive&&e.setInactive()}));this.checkActiveButtons()},checkActiveButtons:function(){var e=[],i=null,n=MediumEditor.selection.getSelectionRange((this||t).document),o,updateExtensionState=function(e){"function"===typeof e.checkState?e.checkState(o):"function"===typeof e.isActive&&"function"===typeof e.isAlreadyApplied&&"function"===typeof e.setActive&&!e.isActive()&&e.isAlreadyApplied(o)&&e.setActive()};if(n){this.forEachExtension((function(t){if("function"===typeof t.queryCommandState){i=t.queryCommandState();if(null!==i){i&&"function"===typeof t.setActive&&t.setActive();return}}e.push(t)}));o=MediumEditor.selection.getSelectedParentElement(n);if(this.getEditorElements().some((function(e){return MediumEditor.util.isDescendant(e,o,true)})))while(o){e.forEach(updateExtensionState);if(MediumEditor.util.isMediumEditorElement(o))break;o=o.parentNode}}},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var e=(this||t).base.getFocusedElement(),i=(this||t).window.getSelection();if(!e)return this||t;if((this||t).static||!i.isCollapsed){this.showToolbar();(this||t).relativeContainer||((this||t).static?this.positionStaticToolbar(e):this.positionToolbar(i));this.trigger("positionedToolbar",{},(this||t).base.getFocusedElement())}},positionStaticToolbar:function(e){this.getToolbarElement().style.left="0";var i=(this||t).document.documentElement&&(this||t).document.documentElement.scrollTop||(this||t).document.body.scrollTop,n=(this||t).window.innerWidth,o=this.getToolbarElement(),r=e.getBoundingClientRect(),s=r.top+i,a=r.left+r.width/2,l=o.offsetHeight,d=o.offsetWidth,u=d/2,c;if((this||t).sticky)if(i>s+e.offsetHeight-l-(this||t).stickyTopOffset){o.style.top=s+e.offsetHeight-l+"px";o.classList.remove("medium-editor-sticky-toolbar")}else if(i>s-l-(this||t).stickyTopOffset){o.classList.add("medium-editor-sticky-toolbar");o.style.top=(this||t).stickyTopOffset+"px"}else{o.classList.remove("medium-editor-sticky-toolbar");o.style.top=s-l+"px"}else o.style.top=s-l+"px";switch((this||t).align){case"left":c=r.left;break;case"right":c=r.right-d;break;case"center":c=a-u;break}c<0?c=0:c+d>n&&(c=n-Math.ceil(d)-1);o.style.left=c+"px"},positionToolbar:function(e){this.getToolbarElement().style.left="0";this.getToolbarElement().style.right="initial";var i=e.getRangeAt(0),n=i.getBoundingClientRect();(!n||0===n.height&&0===n.width&&i.startContainer===i.endContainer)&&(n=1===i.startContainer.nodeType&&i.startContainer.querySelector("img")?i.startContainer.querySelector("img").getBoundingClientRect():i.startContainer.getBoundingClientRect());var o=(this||t).window.innerWidth,r=this.getToolbarElement(),s=r.offsetHeight,a=r.offsetWidth,l=a/2,d=50,u=(this||t).diffLeft-l,c=this.getEditorOption("elementsContainer"),h=["absolute","fixed"].indexOf(window.getComputedStyle(c).getPropertyValue("position"))>-1,m={},f={},p,g;if(h){g=c.getBoundingClientRect();["top","left"].forEach((function(e){f[e]=n[e]-g[e]}));f.width=n.width;f.height=n.height;n=f;o=g.width;m.top=c.scrollTop}else m.top=(this||t).window.pageYOffset;p=n.left+n.width/2;m.top+=n.top-s;if(n.top<d){r.classList.add("medium-toolbar-arrow-over");r.classList.remove("medium-toolbar-arrow-under");m.top+=d+n.height-(this||t).diffTop}else{r.classList.add("medium-toolbar-arrow-under");r.classList.remove("medium-toolbar-arrow-over");m.top+=(this||t).diffTop}if(p<l){m.left=u+l;m.right="initial"}else if(o-p<l){m.left="auto";m.right=0}else{m.left=u+p;m.right="initial"}["top","left","right"].forEach((function(e){r.style[e]=m[e]+(isNaN(m[e])?"":"px")}))}});MediumEditor.extensions.toolbar=e})();(function(){var e=MediumEditor.Extension.extend({init:function(){MediumEditor.Extension.prototype.init.apply(this||t,arguments);this.subscribe("editableDrag",(this||t).handleDrag.bind(this||t));this.subscribe("editableDrop",(this||t).handleDrop.bind(this||t))},handleDrag:function(e){var t="medium-editor-dragover";e.preventDefault();e.dataTransfer.dropEffect="copy";"dragover"===e.type?e.target.classList.add(t):"dragleave"===e.type&&e.target.classList.remove(t)},handleDrop:function(e){var i="medium-editor-dragover",n;e.preventDefault();e.stopPropagation();if(e.dataTransfer.files){n=Array.prototype.slice.call(e.dataTransfer.files,0);n.some(function(e){if(e.type.match("image")){var i,n;i=new FileReader;i.readAsDataURL(e);n="medium-img-"+ +new Date;MediumEditor.util.insertHTMLCommand((this||t).document,'<img class="medium-editor-image-loading" id="'+n+'" />');i.onload=function(){var e=(this||t).document.getElementById(n);if(e){e.removeAttribute("id");e.removeAttribute("class");e.src=i.result}}.bind(this||t)}}.bind(this||t))}e.target.classList.remove(i)}});MediumEditor.extensions.imageDragging=e})();(function(){function handleDisableExtraSpaces(e){var i=MediumEditor.selection.getSelectionStart((this||t).options.ownerDocument),n=i.textContent,o=MediumEditor.selection.getCaretOffsets(i);(void 0===n[o.left-1]||""===n[o.left-1].trim()||void 0!==n[o.left]&&""===n[o.left].trim())&&e.preventDefault()}function handleDisabledEnterKeydown(e,i){if((this||t).options.disableReturn||i.getAttribute("data-disable-return"))e.preventDefault();else if((this||t).options.disableDoubleReturn||i.getAttribute("data-disable-double-return")){var n=MediumEditor.selection.getSelectionStart((this||t).options.ownerDocument);(n&&""===n.textContent.trim()&&"li"!==n.nodeName.toLowerCase()||n.previousElementSibling&&"br"!==n.previousElementSibling.nodeName.toLowerCase()&&""===n.previousElementSibling.textContent.trim())&&e.preventDefault()}}function handleTabKeydown(e){var i=MediumEditor.selection.getSelectionStart((this||t).options.ownerDocument),n=i&&i.nodeName.toLowerCase();if("pre"===n){e.preventDefault();MediumEditor.util.insertHTMLCommand((this||t).options.ownerDocument,"    ")}if(MediumEditor.util.isListItem(i)){e.preventDefault();e.shiftKey?(this||t).options.ownerDocument.execCommand("outdent",false,null):(this||t).options.ownerDocument.execCommand("indent",false,null)}}function handleBlockDeleteKeydowns(e){var i,n=MediumEditor.selection.getSelectionStart((this||t).options.ownerDocument),o=n.nodeName.toLowerCase(),r=/^(\s+|<br\/?>)?$/i,s=/h\d/i;if(MediumEditor.util.isKey(e,[MediumEditor.util.keyCode.BACKSPACE,MediumEditor.util.keyCode.ENTER])&&n.previousElementSibling&&s.test(o)&&0===MediumEditor.selection.getCaretOffsets(n).left){if(MediumEditor.util.isKey(e,MediumEditor.util.keyCode.BACKSPACE)&&r.test(n.previousElementSibling.innerHTML)){n.previousElementSibling.parentNode.removeChild(n.previousElementSibling);e.preventDefault()}else if(!(this||t).options.disableDoubleReturn&&MediumEditor.util.isKey(e,MediumEditor.util.keyCode.ENTER)){i=(this||t).options.ownerDocument.createElement("p");i.innerHTML="<br>";n.previousElementSibling.parentNode.insertBefore(i,n);e.preventDefault()}}else if(MediumEditor.util.isKey(e,MediumEditor.util.keyCode.DELETE)&&n.nextElementSibling&&n.previousElementSibling&&!s.test(o)&&r.test(n.innerHTML)&&s.test(n.nextElementSibling.nodeName.toLowerCase())){MediumEditor.selection.moveCursor((this||t).options.ownerDocument,n.nextElementSibling);n.previousElementSibling.parentNode.removeChild(n);e.preventDefault()}else if(MediumEditor.util.isKey(e,MediumEditor.util.keyCode.BACKSPACE)&&"li"===o&&r.test(n.innerHTML)&&!n.previousElementSibling&&!n.parentElement.previousElementSibling&&n.nextElementSibling&&"li"===n.nextElementSibling.nodeName.toLowerCase()){i=(this||t).options.ownerDocument.createElement("p");i.innerHTML="<br>";n.parentElement.parentElement.insertBefore(i,n.parentElement);MediumEditor.selection.moveCursor((this||t).options.ownerDocument,i);n.parentElement.removeChild(n);e.preventDefault()}else if(MediumEditor.util.isKey(e,MediumEditor.util.keyCode.BACKSPACE)&&false!==MediumEditor.util.getClosestTag(n,"blockquote")&&0===MediumEditor.selection.getCaretOffsets(n).left){e.preventDefault();MediumEditor.util.execFormatBlock((this||t).options.ownerDocument,"p")}else if(MediumEditor.util.isKey(e,MediumEditor.util.keyCode.ENTER)&&false!==MediumEditor.util.getClosestTag(n,"blockquote")&&0===MediumEditor.selection.getCaretOffsets(n).right){i=(this||t).options.ownerDocument.createElement("p");i.innerHTML="<br>";n.parentElement.insertBefore(i,n.nextSibling);MediumEditor.selection.moveCursor((this||t).options.ownerDocument,i);e.preventDefault()}else if(MediumEditor.util.isKey(e,MediumEditor.util.keyCode.BACKSPACE)&&MediumEditor.util.isMediumEditorElement(n.parentElement)&&!n.previousElementSibling&&n.nextElementSibling&&r.test(n.innerHTML)){e.preventDefault();MediumEditor.selection.moveCursor((this||t).options.ownerDocument,n.nextSibling);n.parentElement.removeChild(n)}}function handleKeyup(e){var i=MediumEditor.selection.getSelectionStart((this||t).options.ownerDocument),n;if(i){MediumEditor.util.isMediumEditorElement(i)&&0===i.children.length&&!MediumEditor.util.isBlockContainer(i)&&(this||t).options.ownerDocument.execCommand("formatBlock",false,"p");if(MediumEditor.util.isKey(e,MediumEditor.util.keyCode.ENTER)&&!MediumEditor.util.isListItem(i)&&!MediumEditor.util.isBlockContainer(i)){n=i.nodeName.toLowerCase();"a"===n?(this||t).options.ownerDocument.execCommand("unlink",false,null):e.shiftKey||e.ctrlKey||(this||t).options.ownerDocument.execCommand("formatBlock",false,"p")}}}function handleEditableInput(e,t){var i=t.parentNode.querySelector('textarea[medium-editor-textarea-id="'+t.getAttribute("medium-editor-textarea-id")+'"]');i&&(i.value=t.innerHTML.trim())}function addToEditors(e){e._mediumEditors||(e._mediumEditors=[null]);(this||t).id||((this||t).id=e._mediumEditors.length);e._mediumEditors[(this||t).id]=this||t}function removeFromEditors(e){e._mediumEditors&&e._mediumEditors[(this||t).id]&&(e._mediumEditors[(this||t).id]=null)}function createElementsArray(e,t,i){var n=[];e||(e=[]);"string"===typeof e&&(e=t.querySelectorAll(e));MediumEditor.util.isElement(e)&&(e=[e]);if(i)for(var o=0;o<e.length;o++){var r=e[o];!MediumEditor.util.isElement(r)||r.getAttribute("data-medium-editor-element")||r.getAttribute("medium-editor-textarea-id")||n.push(r)}else n=Array.prototype.slice.apply(e);return n}function cleanupTextareaElement(e){var t=e.parentNode.querySelector('textarea[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]');if(t){t.classList.remove("medium-editor-hidden");t.removeAttribute("medium-editor-textarea-id")}e.parentNode&&e.parentNode.removeChild(e)}function setExtensionDefaults(e,t){Object.keys(t).forEach((function(i){void 0===e[i]&&(e[i]=t[i])}));return e}function initExtension(e,t,i){var n={window:i.options.contentWindow,document:i.options.ownerDocument,base:i};e=setExtensionDefaults(e,n);"function"===typeof e.init&&e.init();e.name||(e.name=t);return e}function isToolbarEnabled(){return!(this||t).elements.every((function(e){return!!e.getAttribute("data-disable-toolbar")}))&&false!==(this||t).options.toolbar}function isAnchorPreviewEnabled(){return!!isToolbarEnabled.call(this||t)&&false!==(this||t).options.anchorPreview}function isPlaceholderEnabled(){return false!==(this||t).options.placeholder}function isAutoLinkEnabled(){return false!==(this||t).options.autoLink}function isImageDraggingEnabled(){return false!==(this||t).options.imageDragging}function isKeyboardCommandsEnabled(){return false!==(this||t).options.keyboardCommands}function shouldUseFileDraggingExtension(){return!(this||t).options.extensions["imageDragging"]}function createContentEditable(e){var i=(this||t).options.ownerDocument.createElement("div"),n=Date.now(),o="medium-editor-"+n,r=e.attributes;while((this||t).options.ownerDocument.getElementById(o)){n++;o="medium-editor-"+n}i.className=e.className;i.id=o;i.innerHTML=e.value;e.setAttribute("medium-editor-textarea-id",o);for(var s=0,a=r.length;s<a;s++)i.hasAttribute(r[s].nodeName)||i.setAttribute(r[s].nodeName,r[s].value);e.form&&this.on(e.form,"reset",function(e){e.defaultPrevented||this.resetContent((this||t).options.ownerDocument.getElementById(o))}.bind(this||t));e.classList.add("medium-editor-hidden");e.parentNode.insertBefore(i,e);return i}function initElement(i,n){if(!i.getAttribute("data-medium-editor-element")){if("textarea"===i.nodeName.toLowerCase()){i=createContentEditable.call(this||t,i);if(!(this||t).instanceHandleEditableInput){(this||t).instanceHandleEditableInput=handleEditableInput.bind(this||t);this.subscribe("editableInput",(this||t).instanceHandleEditableInput)}}if(!(this||t).options.disableEditing&&!i.getAttribute("data-disable-editing")){i.setAttribute("contentEditable",true);i.setAttribute("spellcheck",(this||t).options.spellcheck)}if(!(this||t).instanceHandleEditableKeydownEnter&&(i.getAttribute("data-disable-return")||i.getAttribute("data-disable-double-return"))){(this||t).instanceHandleEditableKeydownEnter=handleDisabledEnterKeydown.bind(this||t);this.subscribe("editableKeydownEnter",(this||t).instanceHandleEditableKeydownEnter)}(this||t).options.disableReturn||i.getAttribute("data-disable-return")||this.on(i,"keyup",handleKeyup.bind(this||t));var o=MediumEditor.util.guid();i.setAttribute("data-medium-editor-element",true);i.classList.add("medium-editor-element");i.setAttribute("role","textbox");i.setAttribute("aria-multiline",true);i.setAttribute("data-medium-editor-editor-index",n);i.setAttribute("medium-editor-index",o);e[o]=i.innerHTML;(this||t).events.attachAllEventsToElement(i)}return i}function attachHandlers(){this.subscribe("editableKeydownTab",handleTabKeydown.bind(this||t));this.subscribe("editableKeydownDelete",handleBlockDeleteKeydowns.bind(this||t));this.subscribe("editableKeydownEnter",handleBlockDeleteKeydowns.bind(this||t));(this||t).options.disableExtraSpaces&&this.subscribe("editableKeydownSpace",handleDisableExtraSpaces.bind(this||t));if(!(this||t).instanceHandleEditableKeydownEnter&&((this||t).options.disableReturn||(this||t).options.disableDoubleReturn)){(this||t).instanceHandleEditableKeydownEnter=handleDisabledEnterKeydown.bind(this||t);this.subscribe("editableKeydownEnter",(this||t).instanceHandleEditableKeydownEnter)}}function initExtensions(){(this||t).extensions=[];Object.keys((this||t).options.extensions).forEach((function(e){"toolbar"!==e&&(this||t).options.extensions[e]&&(this||t).extensions.push(initExtension((this||t).options.extensions[e],e,this||t))}),this||t);if(shouldUseFileDraggingExtension.call(this||t)){var e=(this||t).options.fileDragging;if(!e){e={};isImageDraggingEnabled.call(this||t)||(e.allowedTypes=[])}this.addBuiltInExtension("fileDragging",e)}var i={paste:true,"anchor-preview":isAnchorPreviewEnabled.call(this||t),autoLink:isAutoLinkEnabled.call(this||t),keyboardCommands:isKeyboardCommandsEnabled.call(this||t),placeholder:isPlaceholderEnabled.call(this||t)};Object.keys(i).forEach((function(e){i[e]&&this.addBuiltInExtension(e)}),this||t);var n=(this||t).options.extensions["toolbar"];if(!n&&isToolbarEnabled.call(this||t)){var o=MediumEditor.util.extend({},(this||t).options.toolbar,{allowMultiParagraphSelection:(this||t).options.allowMultiParagraphSelection});n=new MediumEditor.extensions.toolbar(o)}n&&(this||t).extensions.push(initExtension(n,"toolbar",this||t))}function mergeOptions(e,t){var i=[["allowMultiParagraphSelection","toolbar.allowMultiParagraphSelection"]];t&&i.forEach((function(e){t.hasOwnProperty(e[0])&&void 0!==t[e[0]]&&MediumEditor.util.deprecated(e[0],e[1],"v6.0.0")}));return MediumEditor.util.defaults({},t,e)}function execActionInternal(e,i){var n=/^append-(.+)$/gi,o=/justify([A-Za-z]*)$/g,r,s;r=n.exec(e);if(r)return MediumEditor.util.execFormatBlock((this||t).options.ownerDocument,r[1]);if("fontSize"===e){i.size&&MediumEditor.util.deprecated(".size option for fontSize command",".value","6.0.0");s=i.value||i.size;return(this||t).options.ownerDocument.execCommand("fontSize",false,s)}if("fontName"===e){i.name&&MediumEditor.util.deprecated(".name option for fontName command",".value","6.0.0");s=i.value||i.name;return(this||t).options.ownerDocument.execCommand("fontName",false,s)}if("createLink"===e)return this.createLink(i);if("image"===e){var a=(this||t).options.contentWindow.getSelection().toString().trim();return(this||t).options.ownerDocument.execCommand("insertImage",false,a)}if("html"===e){var l=(this||t).options.contentWindow.getSelection().toString().trim();return MediumEditor.util.insertHTMLCommand((this||t).options.ownerDocument,l)}if(o.exec(e)){var d=(this||t).options.ownerDocument.execCommand(e,false,null),u=MediumEditor.selection.getSelectedParentElement(MediumEditor.selection.getSelectionRange((this||t).options.ownerDocument));u&&cleanupJustifyDivFragments.call(this||t,MediumEditor.util.getTopBlockContainer(u));return d}s=i&&i.value;return(this||t).options.ownerDocument.execCommand(e,false,s)}function cleanupJustifyDivFragments(e){if(e){var i,n=Array.prototype.slice.call(e.childNodes).filter((function(e){var t="div"===e.nodeName.toLowerCase();t&&!i&&(i=e.style.textAlign);return t}));if(n.length){this.saveSelection();n.forEach((function(e){if(e.style.textAlign===i){var n=e.lastChild;if(n){MediumEditor.util.unwrap(e,(this||t).options.ownerDocument);var o=(this||t).options.ownerDocument.createElement("BR");n.parentNode.insertBefore(o,n.nextSibling)}}}),this||t);e.style.textAlign=i;this.restoreSelection()}}}var e={};MediumEditor.prototype={init:function(e,i){(this||t).options=mergeOptions.call(this||t,(this||t).defaults,i);(this||t).origElements=e;(this||t).options.elementsContainer||((this||t).options.elementsContainer=(this||t).options.ownerDocument.body);return this.setup()},setup:function(){if(!(this||t).isActive){addToEditors.call(this||t,(this||t).options.contentWindow);(this||t).events=new MediumEditor.Events(this||t);(this||t).elements=[];this.addElements((this||t).origElements);if(0!==(this||t).elements.length){(this||t).isActive=true;initExtensions.call(this||t);attachHandlers.call(this||t)}}},destroy:function(){if((this||t).isActive){(this||t).isActive=false;(this||t).extensions.forEach((function(e){"function"===typeof e.destroy&&e.destroy()}),this||t);(this||t).events.destroy();(this||t).elements.forEach((function(e){(this||t).options.spellcheck&&(e.innerHTML=e.innerHTML);e.removeAttribute("contentEditable");e.removeAttribute("spellcheck");e.removeAttribute("data-medium-editor-element");e.classList.remove("medium-editor-element");e.removeAttribute("role");e.removeAttribute("aria-multiline");e.removeAttribute("medium-editor-index");e.removeAttribute("data-medium-editor-editor-index");e.getAttribute("medium-editor-textarea-id")&&cleanupTextareaElement(e)}),this||t);(this||t).elements=[];(this||t).instanceHandleEditableKeydownEnter=null;(this||t).instanceHandleEditableInput=null;removeFromEditors.call(this||t,(this||t).options.contentWindow)}},on:function(e,i,n,o){(this||t).events.attachDOMEvent(e,i,n,o);return this||t},off:function(e,i,n,o){(this||t).events.detachDOMEvent(e,i,n,o);return this||t},subscribe:function(e,i){(this||t).events.attachCustomEvent(e,i);return this||t},unsubscribe:function(e,i){(this||t).events.detachCustomEvent(e,i);return this||t},trigger:function(e,i,n){(this||t).events.triggerCustomEvent(e,i,n);return this||t},delay:function(e){var i=this||t;return setTimeout((function(){i.isActive&&e()}),(this||t).options.delay)},serialize:function(){var e,i,n={},o=(this||t).elements.length;for(e=0;e<o;e+=1){i=""!==(this||t).elements[e].id?(this||t).elements[e].id:"element-"+e;n[i]={value:(this||t).elements[e].innerHTML.trim()}}return n},getExtensionByName:function(e){var i;(this||t).extensions&&(this||t).extensions.length&&(this||t).extensions.some((function(t){if(t.name===e){i=t;return true}return false}));return i},addBuiltInExtension:function(e,i){var n=this.getExtensionByName(e),o;if(n)return n;switch(e){case"anchor":o=MediumEditor.util.extend({},(this||t).options.anchor,i);n=new MediumEditor.extensions.anchor(o);break;case"anchor-preview":n=new MediumEditor.extensions.anchorPreview((this||t).options.anchorPreview);break;case"autoLink":n=new MediumEditor.extensions.autoLink;break;case"fileDragging":n=new MediumEditor.extensions.fileDragging(i);break;case"fontname":n=new MediumEditor.extensions.fontName((this||t).options.fontName);break;case"fontsize":n=new MediumEditor.extensions.fontSize(i);break;case"keyboardCommands":n=new MediumEditor.extensions.keyboardCommands((this||t).options.keyboardCommands);break;case"paste":n=new MediumEditor.extensions.paste((this||t).options.paste);break;case"placeholder":n=new MediumEditor.extensions.placeholder((this||t).options.placeholder);break;default:if(MediumEditor.extensions.button.isBuiltInButton(e))if(i){o=MediumEditor.util.defaults({},i,MediumEditor.extensions.button.prototype.defaults[e]);n=new MediumEditor.extensions.button(o)}else n=new MediumEditor.extensions.button(e)}n&&(this||t).extensions.push(initExtension(n,e,this||t));return n},stopSelectionUpdates:function(){(this||t).preventSelectionUpdates=true},startSelectionUpdates:function(){(this||t).preventSelectionUpdates=false},checkSelection:function(){var e=this.getExtensionByName("toolbar");e&&e.checkState();return this||t},queryCommandState:function(e){var i=/^full-(.+)$/gi,n,o=null;n=i.exec(e);n&&(e=n[1]);try{o=(this||t).options.ownerDocument.queryCommandState(e)}catch(e){o=null}return o},execAction:function(e,i){var n=/^full-(.+)$/gi,o,r;o=n.exec(e);if(o){this.saveSelection();this.selectAllContents();r=execActionInternal.call(this||t,o[1],i);this.restoreSelection()}else r=execActionInternal.call(this||t,e,i);"insertunorderedlist"!==e&&"insertorderedlist"!==e||MediumEditor.util.cleanListDOM((this||t).options.ownerDocument,this.getSelectedParentElement());this.checkSelection();return r},getSelectedParentElement:function(e){void 0===e&&(e=(this||t).options.contentWindow.getSelection().getRangeAt(0));return MediumEditor.selection.getSelectedParentElement(e)},selectAllContents:function(){var e=MediumEditor.selection.getSelectionElement((this||t).options.contentWindow);if(e){while(1===e.children.length)e=e.children[0];this.selectElement(e)}},selectElement:function(e){MediumEditor.selection.selectNode(e,(this||t).options.ownerDocument);var i=MediumEditor.selection.getSelectionElement((this||t).options.contentWindow);i&&(this||t).events.focusElement(i)},getFocusedElement:function(){var e;(this||t).elements.some((function(t){!e&&t.getAttribute("data-medium-focused")&&(e=t);return!!e}),this||t);return e},exportSelection:function(){var e=MediumEditor.selection.getSelectionElement((this||t).options.contentWindow),i=(this||t).elements.indexOf(e),n=null;i>=0&&(n=MediumEditor.selection.exportSelection(e,(this||t).options.ownerDocument));null!==n&&0!==i&&(n.editableElementIndex=i);return n},saveSelection:function(){(this||t).selectionState=this.exportSelection()},importSelection:function(e,i){if(e){var n=(this||t).elements[e.editableElementIndex||0];MediumEditor.selection.importSelection(e,n,(this||t).options.ownerDocument,i)}},restoreSelection:function(){this.importSelection((this||t).selectionState)},createLink:function(e){var i=MediumEditor.selection.getSelectionElement((this||t).options.contentWindow),n={},o;if(-1!==(this||t).elements.indexOf(i)){try{(this||t).events.disableCustomEvent("editableInput");e.url&&MediumEditor.util.deprecated(".url option for createLink",".value","6.0.0");o=e.url||e.value;if(o&&o.trim().length>0){var r=(this||t).options.contentWindow.getSelection();if(r){var s=r.getRangeAt(0),a=s.commonAncestorContainer,l,d,u,c;3===s.endContainer.nodeType&&3!==s.startContainer.nodeType&&0===s.startOffset&&s.startContainer.firstChild===s.endContainer&&(a=s.endContainer);d=MediumEditor.util.getClosestBlockContainer(s.startContainer);u=MediumEditor.util.getClosestBlockContainer(s.endContainer);if(3!==a.nodeType&&0!==a.textContent.length&&d===u){var h=d||i,m=(this||t).options.ownerDocument.createDocumentFragment();this.execAction("unlink");l=this.exportSelection();m.appendChild(h.cloneNode(true));i===h?MediumEditor.selection.select((this||t).options.ownerDocument,h.firstChild,0,h.lastChild,3===h.lastChild.nodeType?h.lastChild.nodeValue.length:h.lastChild.childNodes.length):MediumEditor.selection.select((this||t).options.ownerDocument,h,0,h,h.childNodes.length);var f=this.exportSelection();c=MediumEditor.util.findOrCreateMatchingTextNodes((this||t).options.ownerDocument,m,{start:l.start-f.start,end:l.end-f.start,editableElementIndex:l.editableElementIndex});if(0===c.length){m=(this||t).options.ownerDocument.createDocumentFragment();m.appendChild(a.cloneNode(true));c=[m.firstChild.firstChild,m.firstChild.lastChild]}MediumEditor.util.createLink((this||t).options.ownerDocument,c,o.trim());var p=(m.firstChild.innerHTML.match(/^\s+/)||[""])[0].length;MediumEditor.util.insertHTMLCommand((this||t).options.ownerDocument,m.firstChild.innerHTML.replace(/^\s+/,""));l.start-=p;l.end-=p;this.importSelection(l)}else(this||t).options.ownerDocument.execCommand("createLink",false,o);(this||t).options.targetBlank||"_blank"===e.target?MediumEditor.util.setTargetBlank(MediumEditor.selection.getSelectionStart((this||t).options.ownerDocument),o):MediumEditor.util.removeTargetBlank(MediumEditor.selection.getSelectionStart((this||t).options.ownerDocument),o);e.buttonClass&&MediumEditor.util.addClassToAnchors(MediumEditor.selection.getSelectionStart((this||t).options.ownerDocument),e.buttonClass)}}if((this||t).options.targetBlank||"_blank"===e.target||e.buttonClass){n=(this||t).options.ownerDocument.createEvent("HTMLEvents");n.initEvent("input",true,true,(this||t).options.contentWindow);for(var g=0,b=(this||t).elements.length;g<b;g+=1)(this||t).elements[g].dispatchEvent(n)}}finally{(this||t).events.enableCustomEvent("editableInput")}(this||t).events.triggerCustomEvent("editableInput",n,i)}},cleanPaste:function(e){this.getExtensionByName("paste").cleanPaste(e)},pasteHTML:function(e,t){this.getExtensionByName("paste").pasteHTML(e,t)},setContent:function(e,i){i=i||0;if((this||t).elements[i]){var n=(this||t).elements[i];n.innerHTML=e;this.checkContentChanged(n)}},getContent:function(e){e=e||0;return(this||t).elements[e]?(this||t).elements[e].innerHTML.trim():null},checkContentChanged:function(e){e=e||MediumEditor.selection.getSelectionElement((this||t).options.contentWindow);(this||t).events.updateInput(e,{target:e,currentTarget:e})},resetContent:function(i){if(i){var n=(this||t).elements.indexOf(i);-1!==n&&this.setContent(e[i.getAttribute("medium-editor-index")],n)}else(this||t).elements.forEach((function(t,i){this.setContent(e[t.getAttribute("medium-editor-index")],i)}),this||t)},addElements:function(e){var i=createElementsArray(e,(this||t).options.ownerDocument,true);if(0===i.length)return false;i.forEach((function(e){e=initElement.call(this||t,e,(this||t).id);(this||t).elements.push(e);this.trigger("addElement",{target:e,currentTarget:e},e)}),this||t)},removeElements:function(e){var i=createElementsArray(e,(this||t).options.ownerDocument),n=i.map((function(e){return e.getAttribute("medium-editor-textarea-id")&&e.parentNode?e.parentNode.querySelector('div[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]'):e}));(this||t).elements=(this||t).elements.filter((function(e){if(-1!==n.indexOf(e)){(this||t).events.cleanupElement(e);e.getAttribute("medium-editor-textarea-id")&&cleanupTextareaElement(e);this.trigger("removeElement",{target:e,currentTarget:e},e);return false}return true}),this||t)}};MediumEditor.getEditorFromElement=function(e){var t=e.getAttribute("data-medium-editor-editor-index"),i=e&&e.ownerDocument&&(e.ownerDocument.defaultView||e.ownerDocument.parentWindow);return i&&i._mediumEditors&&i._mediumEditors[t]?i._mediumEditors[t]:null}})();(function(){MediumEditor.prototype.defaults={activeButtonClass:"medium-editor-button-active",buttonLabels:false,delay:0,disableReturn:false,disableDoubleReturn:false,disableExtraSpaces:false,disableEditing:false,autoLink:false,elementsContainer:false,contentWindow:window,ownerDocument:document,targetBlank:false,extensions:{},spellcheck:true}})();MediumEditor.parseVersionString=function(e){var t=e.split("-"),i=t[0].split("."),n=t.length>1?t[1]:"";return{major:parseInt(i[0],10),minor:parseInt(i[1],10),revision:parseInt(i[2],10),preRelease:n,toString:function(){return[i[0],i[1],i[2]].join(".")+(n?"-"+n:"")}}};MediumEditor.version=MediumEditor.parseVersionString.call(this||t,["5.23.3"][0]);return MediumEditor}());var o=i;export default o;

