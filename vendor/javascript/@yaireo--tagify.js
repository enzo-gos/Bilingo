var n="&#8203;";function e(n,x){(null==x||x>n.length)&&(x=n.length);for(var A=0,C=new Array(x);A<x;A++)C[A]=n[A];return C}function i(n){return function(n){if(Array.isArray(n))return e(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,x){if(n){if("string"==typeof n)return e(n,x);var A=Object.prototype.toString.call(n).slice(8,-1);"Object"===A&&n.constructor&&(A=n.constructor.name);return"Map"===A||"Set"===A?Array.from(A):"Arguments"===A||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?e(n,x):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var x={isEnabled:function(){var n;return null===(n=window.TAGIFY_DEBUG)||void 0===n||n},log:function(){for(var n=arguments.length,x=new Array(n),A=0;A<n;A++)x[A]=arguments[A];var C;this.isEnabled()&&(C=console).log.apply(C,["[Tagify]:"].concat(i(x)))},warn:function(){for(var n=arguments.length,x=new Array(n),A=0;A<n;A++)x[A]=arguments[A];var C;this.isEnabled()&&(C=console).warn.apply(C,["[Tagify]:"].concat(i(x)))}},s=function(n,x,A,C){return n=""+n,x=""+x,C&&(n=n.trim(),x=x.trim()),A?n==x:n.toLowerCase()==x.toLowerCase()},a=function(n,x){return n&&Array.isArray(n)&&n.map((function(n){return o(n,x)}))};function o(n,x){var A,C={};for(A in n)x.indexOf(A)<0&&(C[A]=n[A]);return C}function r(n){var x=document.createElement("div");return n.replace(/\&#?[0-9a-z]+;/gi,(function(n){return x.innerHTML=n,x.innerText}))}function l(n){return(new DOMParser).parseFromString(n.trim(),"text/html").body.firstElementChild}function d(n,x){for(x=x||"previous";n=n[x+"Sibling"];)if(3==n.nodeType)return n}function c(n){return"string"==typeof n?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/`|'/g,"&#039;"):n}function u(n){var x=Object.prototype.toString.call(n).split(" ")[1].slice(0,-1);return n===Object(n)&&"Array"!=x&&"Function"!=x&&"RegExp"!=x&&"HTMLUnknownElement"!=x}function g(n,x,A){var C,k;function a(n,x){for(var A in x)if(x.hasOwnProperty(A)){if(u(x[A])){u(n[A])?a(n[A],x[A]):n[A]=Object.assign({},x[A]);continue}if(Array.isArray(x[A])){n[A]=Object.assign([],x[A]);continue}n[A]=x[A]}}return C=n,(null!=(k=Object)&&"undefined"!=typeof Symbol&&k[Symbol.hasInstance]?k[Symbol.hasInstance](C):C instanceof k)||(n={}),a(n,x),A&&a(n,A),n}function h(){var n=[],x={},A=!0,C=!1,k=void 0;try{for(var L,j=arguments[Symbol.iterator]();!(A=(L=j.next()).done);A=!0){var P=L.value,V=!0,z=!1,Z=void 0;try{for(var tt,et=P[Symbol.iterator]();!(V=(tt=et.next()).done);V=!0){var it=tt.value;u(it)?x[it.value]||(n.push(it),x[it.value]=1):n.includes(it)||n.push(it)}}catch(n){z=!0,Z=n}finally{try{V||null==et.return||et.return()}finally{if(z)throw Z}}}}catch(n){C=!0,k=n}finally{try{A||null==j.return||j.return()}finally{if(C)throw k}}return n}function p(n){return String.prototype.normalize?"string"==typeof n?n.normalize("NFD").replace(/[\u0300-\u036f]/g,""):void 0:n}var f=function(){return/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent)};function m(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(n){return(n^crypto.getRandomValues(new Uint8Array(1))[0]&15>>n/4).toString(16)}))}function v(n){return n&&n.classList&&n.classList.contains(this.settings.classNames.tag)}function b(n){return n&&n.closest(this.settings.classNames.tagSelector)}function w(n,x){var A=window.getSelection();return x=x||A.getRangeAt(0),"string"==typeof n&&(n=document.createTextNode(n)),x&&(x.deleteContents(),x.insertNode(n)),n}function y(n,A,C){return n?(A&&(n.__tagifyTagData=C?A:g({},n.__tagifyTagData||{},A)),n.__tagifyTagData):(x.warn("tag element doesn't exist",{tagElm:n,data:A}),A)}function T(n){if(n&&n.parentNode){var x=n,A=window.getSelection(),C=A.getRangeAt(0);A.rangeCount&&(C.setStartAfter(x),C.collapse(!0),A.removeAllRanges(),A.addRange(C))}}function O(n,x){n.forEach((function(n){if(y(n.previousSibling)||!n.previousSibling){var A=document.createTextNode("​");n.before(A),x&&T(A)}}))}var A={delimiters:",",pattern:null,tagTextProp:"value",maxTags:1/0,callbacks:{},addTagOnBlur:!0,addTagOn:["blur","tab","enter"],onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,focusable:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\.|\:|\s/,mixTagsInterpolator:["[[","]]"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:function(){},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:" "},autoComplete:{enabled:!0,rightKey:!1,tabKey:!1},classNames:{namespace:"tagify",mixMode:"tagify--mix",selectMode:"tagify--select",input:"tagify__input",focus:"tagify--focus",tagNoAnimation:"tagify--noAnim",tagInvalid:"tagify--invalid",tagNotAllowed:"tagify--notAllowed",scopeLoading:"tagify--loading",hasMaxTags:"tagify--hasMaxTags",hasNoTags:"tagify--noTags",empty:"tagify--empty",inputInvalid:"tagify__input--invalid",dropdown:"tagify__dropdown",dropdownWrapper:"tagify__dropdown__wrapper",dropdownHeader:"tagify__dropdown__header",dropdownFooter:"tagify__dropdown__footer",dropdownItem:"tagify__dropdown__item",dropdownItemActive:"tagify__dropdown__item--active",dropdownItemHidden:"tagify__dropdown__item--hidden",dropdownInital:"tagify__dropdown--initial",tag:"tagify__tag",tagText:"tagify__tag-text",tagX:"tagify__tag__removeBtn",tagLoading:"tagify__tag--loading",tagEditing:"tagify__tag--editable",tagFlash:"tagify__tag--flash",tagHide:"tagify__tag--hide"},dropdown:{classname:"",enabled:2,maxItems:10,searchKeys:["value","searchBy"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,escapeHTML:!0,highlightFirst:!0,closeOnSelect:!0,clearOnSelect:!0,position:"all",appendTarget:null},hooks:{beforeRemoveTag:function(){return Promise.resolve()},beforePaste:function(){return Promise.resolve()},suggestionClick:function(){return Promise.resolve()},beforeKeyDown:function(){return Promise.resolve()}}};function D(n,x,A){return x in n?Object.defineProperty(n,x,{value:A,enumerable:!0,configurable:!0,writable:!0}):n[x]=A,n}function S(n){for(var x=1;x<arguments.length;x++){var A=null!=arguments[x]?arguments[x]:{},C=Object.keys(A);"function"==typeof Object.getOwnPropertySymbols&&(C=C.concat(Object.getOwnPropertySymbols(A).filter((function(n){return Object.getOwnPropertyDescriptor(A,n).enumerable})))),C.forEach((function(x){D(n,x,A[x])}))}return n}function I(n,x){return x=null!=x?x:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(x)):function(n,x){var A=Object.keys(n);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(n);x&&(C=C.filter((function(x){return Object.getOwnPropertyDescriptor(n,x).enumerable}))),A.push.apply(A,C)}return A}(Object(x)).forEach((function(A){Object.defineProperty(n,A,Object.getOwnPropertyDescriptor(x,A))})),n}function M(n,x){(null==x||x>n.length)&&(x=n.length);for(var A=0,C=new Array(x);A<x;A++)C[A]=n[A];return C}function E(n,x,A){return x in n?Object.defineProperty(n,x,{value:A,enumerable:!0,configurable:!0,writable:!0}):n[x]=A,n}function N(n){return function(n){if(Array.isArray(n))return M(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,x){if(n){if("string"==typeof n)return M(n,x);var A=Object.prototype.toString.call(n).slice(8,-1);"Object"===A&&n.constructor&&(A=n.constructor.name);return"Map"===A||"Set"===A?Array.from(A):"Arguments"===A||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?M(n,x):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(){for(var n in this.dropdown={},this._dropdown)this.dropdown[n]="function"==typeof this._dropdown[n]?this._dropdown[n].bind(this):this._dropdown[n];this.dropdown.refs(),this.DOM.dropdown.__tagify=this}var C,k,L,j=(C=function(n){for(var x=1;x<arguments.length;x++){var A=null!=arguments[x]?arguments[x]:{},C=Object.keys(A);"function"==typeof Object.getOwnPropertySymbols&&(C=C.concat(Object.getOwnPropertySymbols(A).filter((function(n){return Object.getOwnPropertyDescriptor(A,n).enumerable})))),C.forEach((function(x){E(n,x,A[x])}))}return n}({},{events:{binding:function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],x=this.dropdown.events.callbacks,A=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:x.onKeyDown.bind(this),onMouseOver:x.onMouseOver.bind(this),onMouseLeave:x.onMouseLeave.bind(this),onClick:x.onClick.bind(this),onScroll:x.onScroll.bind(this)},C=n?"addEventListener":"removeEventListener";"manual"!=this.settings.dropdown.position&&(document[C]("scroll",A.position,!0),window[C]("resize",A.position),window[C]("keydown",A.onKeyDown)),this.DOM.dropdown[C]("mouseover",A.onMouseOver),this.DOM.dropdown[C]("mouseleave",A.onMouseLeave),this.DOM.dropdown[C]("mousedown",A.onClick),this.DOM.dropdown.content[C]("scroll",A.onScroll)},callbacks:{onKeyDown:function(n){var A=this;if(this.state.hasFocus&&!this.state.composing){var C=this.settings,k=this.DOM.dropdown.querySelector(C.classNames.dropdownItemActiveSelector),L=this.dropdown.getSuggestionDataByNode(k),j="mix"==C.mode,P="select"==C.mode;C.hooks.beforeKeyDown(n,{tagify:this}).then((function(V){switch(n.key){case"ArrowDown":case"ArrowUp":case"Down":case"Up":n.preventDefault();var z=A.dropdown.getAllSuggestionsRefs(),Z="ArrowUp"==n.key||"Up"==n.key;k&&(k=A.dropdown.getNextOrPrevOption(k,!Z)),k&&k.matches(C.classNames.dropdownItemSelector)||(k=z[Z?z.length-1:0]),A.dropdown.highlightOption(k,!0);break;case"Escape":case"Esc":A.dropdown.hide();break;case"ArrowRight":if(A.state.actions.ArrowLeft)return;case"Tab":var tt=!C.autoComplete.rightKey||!C.autoComplete.tabKey;if(!j&&!P&&k&&tt&&!A.state.editing){n.preventDefault();var et=A.dropdown.getMappedValue(L);return A.input.autocomplete.set.call(A,et),!1}return!0;case"Enter":n.preventDefault(),C.hooks.suggestionClick(n,{tagify:A,tagData:L,suggestionElm:k}).then((function(){if(k)return A.dropdown.selectOption(k),k=A.dropdown.getNextOrPrevOption(k,!Z),void A.dropdown.highlightOption(k);A.dropdown.hide(),j||A.addTags(A.state.inputText.trim(),!0)})).catch((function(n){return x.warn(n)}));break;case"Backspace":if(j||A.state.editing.scope)return;var it=A.input.raw.call(A);""!=it&&8203!=it.charCodeAt(0)||(!0===C.backspace?A.removeTags():"edit"==C.backspace&&setTimeout(A.editTag.bind(A),0))}}))}},onMouseOver:function(n){var x=n.target.closest(this.settings.classNames.dropdownItemSelector);this.dropdown.highlightOption(x)},onMouseLeave:function(n){this.dropdown.highlightOption()},onClick:function(n){var A=this;if(0==n.button&&n.target!=this.DOM.dropdown&&n.target!=this.DOM.dropdown.content){var C=n.target.closest(this.settings.classNames.dropdownItemSelector),k=this.dropdown.getSuggestionDataByNode(C);this.state.actions.selectOption=!0,setTimeout((function(){return A.state.actions.selectOption=!1}),50),this.settings.hooks.suggestionClick(n,{tagify:this,tagData:k,suggestionElm:C}).then((function(){C?A.dropdown.selectOption(C,n):A.dropdown.hide()})).catch((function(n){return x.warn(n)}))}},onScroll:function(n){var x=n.target,A=x.scrollTop/(x.scrollHeight-x.parentNode.clientHeight)*100;this.trigger("dropdown:scroll",{percentage:Math.round(A)})}}},refilter:function(n){n=n||this.state.dropdown.query||"",this.suggestedListItems=this.dropdown.filterListItems(n),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger("dropdown:updated",this.DOM.dropdown)},getSuggestionDataByNode:function(n){var x=n&&n.getAttribute("value");return this.suggestedListItems.find((function(n){return n.value==x}))||null},getNextOrPrevOption:function(n){var x=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],A=this.dropdown.getAllSuggestionsRefs(),C=A.findIndex((function(x){return x===n}));return x?A[C+1]:A[C-1]},highlightOption:function(n,x){var A,C=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(C),this.state.ddItemElm.removeAttribute("aria-selected")),!n)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);A=this.dropdown.getSuggestionDataByNode(n),this.state.ddItemData=A,this.state.ddItemElm=n,n.classList.add(C),n.setAttribute("aria-selected",!0),x&&(n.parentNode.scrollTop=n.clientHeight+n.offsetTop-n.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,A),this.dropdown.position())},selectOption:function(n,x){var A=this,C=this.settings,k=C.dropdown,L=k.clearOnSelect,j=k.closeOnSelect;if(!n)return this.addTags(this.state.inputText,!0),void(j&&this.dropdown.hide());x=x||{};var P=n.getAttribute("value"),V="noMatch"==P,z="mix"==C.mode,Z=this.suggestedListItems.find((function(n){var x;return(null!==(x=n.value)&&void 0!==x?x:n)==P}));if(this.trigger("dropdown:select",{data:Z,elm:n,event:x}),P&&(Z||V)){if(this.state.editing){var tt=this.normalizeTags([Z])[0];Z=C.transformTag.call(this,tt)||tt,this.onEditTagDone(null,g({__isValid:!0},Z))}else this[z?"addMixTags":"addTags"]([Z||this.input.raw.call(this)],L);(z||this.DOM.input.parentNode)&&(setTimeout((function(){A.DOM.input.focus(),A.toggleFocusClass(!0)})),j&&setTimeout(this.dropdown.hide.bind(this)),n.addEventListener("transitionend",(function(){A.dropdown.fillHeaderFooter(),setTimeout((function(){n.remove(),A.dropdown.refilter()}),100)}),{once:!0}),n.classList.add(this.settings.classNames.dropdownItemHidden))}else j&&setTimeout(this.dropdown.hide.bind(this))},selectAll:function(n){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems("");var x=this.dropdown.filterListItems("");return n||(x=this.state.dropdown.suggestions),this.addTags(x,!0),this},filterListItems:function(n,x){var A,C,k,L,j,P,l=function(){var n,V,z=void 0,nt=void 0;n=it[at],C=(null!=(V=Object)&&"undefined"!=typeof Symbol&&V[Symbol.hasInstance]?V[Symbol.hasInstance](n):n instanceof V)?it[at]:{value:it[at]};var ot,rt=Object.keys(C).some((function(n){return st.includes(n)}))?st:["value"];Z.fuzzySearch&&!x.exact?(L=rt.reduce((function(n,x){return n+" "+(C[x]||"")}),"").toLowerCase().trim(),Z.accentedSearch&&(L=p(L),P=p(P)),z=0==L.indexOf(P),nt=L===P,ot=L,k=P.toLowerCase().split(" ").every((function(n){return ot.includes(n.toLowerCase())}))):(z=!0,k=rt.some((function(n){var A=""+(C[n]||"");return Z.accentedSearch&&(A=p(A),P=p(P)),Z.caseSensitive||(A=A.toLowerCase()),nt=A===P,x.exact?A===P:0==A.indexOf(P)}))),j=!Z.includeSelectedTags&&A.isTagDuplicate(u(C)?C.value:C),k&&!j&&(nt&&z?et.push(C):"startsWith"==Z.sortby&&z?tt.unshift(C):tt.push(C))},V=this,z=this.settings,Z=z.dropdown,tt=(x=x||{},[]),et=[],it=z.whitelist,nt=Z.maxItems>=0?Z.maxItems:1/0,st=Z.searchKeys,at=0;if(!(n="select"==z.mode&&this.value.length&&this.value[0][z.tagTextProp]==n?"":n)||!st.length)return tt=Z.includeSelectedTags?it:it.filter((function(n){return!V.isTagDuplicate(u(n)?n.value:n)})),this.state.dropdown.suggestions=tt,tt.slice(0,nt);for(P=Z.caseSensitive?""+n:(""+n).toLowerCase();at<it.length;at++)A=this,l();return this.state.dropdown.suggestions=et.concat(tt),"function"==typeof Z.sortby?Z.sortby(et.concat(tt),P):et.concat(tt).slice(0,nt)},getMappedValue:function(n){var x=this.settings.dropdown.mapValueTo;return x?"function"==typeof x?x(n):n[x]||n.value:n.value},createListHTML:function(n){var x=this;return g([],n).map((function(n,A){"string"!=typeof n&&"number"!=typeof n||(n={value:n});var C=x.dropdown.getMappedValue(n);return C="string"==typeof C&&x.settings.dropdown.escapeHTML?c(C):C,x.settings.templates.dropdownItem.apply(x,[I(S({},n),{mappedValue:C}),x])})).join("")}}),k=null!=(k={refs:function(){this.DOM.dropdown=this.parseTemplate("dropdown",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-wrapper']")},getHeaderRef:function(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-header']")},getFooterRef:function(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-footer']")},getAllSuggestionsRefs:function(){return N(this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector))},show:function(n){var x,A,C,k=this,L=this.settings,j="mix"==L.mode&&!L.enforceWhitelist,P=!L.whitelist||!L.whitelist.length,V="manual"==L.dropdown.position;if(n=void 0===n?this.state.inputText:n,!(P&&!j&&!L.templates.dropdownItemNoMatch||!1===L.dropdown.enable||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(n),n&&!this.suggestedListItems.length&&(this.trigger("dropdown:noMatch",n),L.templates.dropdownItemNoMatch&&(C=L.templates.dropdownItemNoMatch.call(this,{value:n}))),!C){if(this.suggestedListItems.length)n&&j&&!this.state.editing.scope&&!s(this.suggestedListItems[0].value,n)&&this.suggestedListItems.unshift({value:n});else{if(!n||!j||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:n}]}A=""+(u(x=this.suggestedListItems[0])?x.value:x),L.autoComplete&&A&&0==A.indexOf(n)&&this.input.autocomplete.suggest.call(this,x)}this.dropdown.fill(C),L.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(L.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=n||!0,this.state.dropdown.query=n,this.setStateSelection(),V||setTimeout((function(){k.dropdown.position(),k.dropdown.render()})),setTimeout((function(){k.trigger("dropdown:show",k.DOM.dropdown)}))}},hide:function(n){var x=this,A=this.DOM,C=A.scope,k=A.dropdown,L="manual"==this.settings.dropdown.position&&!n;if(k&&document.body.contains(k)&&!L)return window.removeEventListener("resize",this.dropdown.position),this.dropdown.events.binding.call(this,!1),C.setAttribute("aria-expanded",!1),k.parentNode.removeChild(k),setTimeout((function(){x.state.dropdown.visible=!1}),100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger("dropdown:hide",k),this},toggle:function(n){this.dropdown[this.state.dropdown.visible&&!n?"hide":"show"]()},getAppendTarget:function(){var n=this.settings.dropdown;return"function"==typeof n.appendTarget?n.appendTarget():n.appendTarget},render:function(){var n,x,A,C=this,k=(n=this.DOM.dropdown,(A=n.cloneNode(!0)).style.cssText="position:fixed; top:-9999px; opacity:0",document.body.appendChild(A),x=A.clientHeight,A.parentNode.removeChild(A),x),L=this.settings,j="number"==typeof L.dropdown.enabled&&L.dropdown.enabled>=0,P=this.dropdown.getAppendTarget();return j?(this.DOM.scope.setAttribute("aria-expanded",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(L.classNames.dropdownInital),this.dropdown.position(k),P.appendChild(this.DOM.dropdown),setTimeout((function(){return C.DOM.dropdown.classList.remove(L.classNames.dropdownInital)}))),this):this},fill:function(n){n="string"==typeof n?n:this.dropdown.createListHTML(n||this.suggestedListItems);var x,A=this.settings.templates.dropdownContent.call(this,n);this.DOM.dropdown.content.innerHTML=(x=A)?x.replace(/\>[\r\n ]+\</g,"><").split(/>\s+</).join("><").trim():""},fillHeaderFooter:function(){var n=this.dropdown.filterListItems(this.state.dropdown.query),x=this.parseTemplate("dropdownHeader",[n]),A=this.parseTemplate("dropdownFooter",[n]),C=this.dropdown.getHeaderRef(),k=this.dropdown.getFooterRef();x&&(null==C||C.parentNode.replaceChild(x,C)),A&&(null==k||k.parentNode.replaceChild(A,k))},position:function(n){var x=this.settings.dropdown,A=this.dropdown.getAppendTarget();if("manual"!=x.position&&A){var C,k,L,j,P,V,z,Z,tt,et=this.DOM.dropdown,it=x.RTL,nt=A===document.body,st=A===this.DOM.scope,at=nt?window.pageYOffset:A.scrollTop,ot=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,rt=ot.clientHeight,lt=Math.max(ot.clientWidth||0,window.innerWidth||0)>480?x.position:"all",dt=this.DOM["input"==lt?"input":"scope"];if(n=n||et.clientHeight,this.state.dropdown.visible){if("text"==lt?(L=(C=function(){var n=document.getSelection();if(n.rangeCount){var x,A,C=n.getRangeAt(0),k=C.startContainer,L=C.startOffset;if(L>0)return(A=document.createRange()).setStart(k,L-1),A.setEnd(k,L),{left:(x=A.getBoundingClientRect()).right,top:x.top,bottom:x.bottom};if(k.getBoundingClientRect)return k.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,k=C.top,j=C.left,P="auto"):(V=function(n){var x=0,A=0;for(n=n.parentNode;n&&n!=ot;)x+=n.offsetTop||0,A+=n.offsetLeft||0,n=n.parentNode;return{top:x,left:A}}(A),C=dt.getBoundingClientRect(),k=st?-1:C.top-V.top,L=(st?C.height:C.bottom-V.top)-1,j=st?-1:C.left-V.left,P=C.width+"px"),!nt){var ct=function(){for(var n=0,A=x.appendTarget.parentNode;A;)n+=A.scrollTop||0,A=A.parentNode;return n}();k+=ct,L+=ct}var ut;k=Math.floor(k),L=Math.ceil(L),Z=((z=null!==(ut=x.placeAbove)&&void 0!==ut?ut:rt-C.bottom<n)?k:L)+at,tt="left: ".concat(j+(it&&C.width||0)+window.pageXOffset,"px;"),et.style.cssText="".concat(tt,"; top: ").concat(Z,"px; min-width: ").concat(P,"; max-width: ").concat(P),et.setAttribute("placement",z?"top":"bottom"),et.setAttribute("position",lt)}}}})?k:{},Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(k)):function(n,x){var A=Object.keys(n);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(n);x&&(C=C.filter((function(x){return Object.getOwnPropertyDescriptor(n,x).enumerable}))),A.push.apply(A,C)}return A}(Object(k)).forEach((function(n){Object.defineProperty(C,n,Object.getOwnPropertyDescriptor(k,n))})),C),P="@yaireo/tagify/",V={empty:"empty",exceed:"number of tags exceeded",pattern:"pattern mismatch",duplicate:"already exists",notAllowed:"not allowed"},z={wrapper:function(x,A){return'<tags class="'.concat(A.classNames.namespace," ").concat(A.mode?"".concat(A.classNames[A.mode+"Mode"]):""," ").concat(x.className,'"\n                    ').concat(A.readonly?"readonly":"","\n                    ").concat(A.disabled?"disabled":"","\n                    ").concat(A.required?"required":"","\n                    ").concat("select"===A.mode?"spellcheck='false'":"",'\n                    tabIndex="-1">\n                    ').concat(this.settings.templates.input.call(this),"\n                ").concat(n,"\n        </tags>")},input:function(){var x=this.settings,A=x.placeholder||n;return"<span ".concat(!x.readonly&&x.userInput?"contenteditable":"",' tabIndex="0" data-placeholder="').concat(A,'" aria-placeholder="').concat(x.placeholder||"",'"\n                    class="').concat(x.classNames.input,'"\n                    role="textbox"\n                    aria-autocomplete="both"\n                    aria-multiline="').concat("mix"==x.mode,'"></span>')},tag:function(n,x){var A=x.settings;return'<tag title="'.concat(n.title||n.value,"\"\n                    contenteditable='false'\n                    spellcheck='false'\n                    tabIndex=\"").concat(A.a11y.focusableTags?0:-1,'"\n                    class="').concat(A.classNames.tag," ").concat(n.class||"",'"\n                    ').concat(this.getAttributes(n),">\n            <x title='' tabIndex=\"").concat(A.a11y.focusableTags?0:-1,'" class="').concat(A.classNames.tagX,"\" role='button' aria-label='remove tag'></x>\n            <div>\n                <span ").concat("select"===A.mode&&A.userInput?"contenteditable='true'":"",' class="').concat(A.classNames.tagText,'">').concat(n[A.tagTextProp]||n.value,"</span>\n            </div>\n        </tag>")},dropdown:function(n){var x=n.dropdown,A="manual"==x.position;return'<div class="'.concat(A?"":n.classNames.dropdown," ").concat(x.classname,'" role="listbox" aria-labelledby="dropdown" dir="').concat(x.RTL?"rtl":"","\">\n                    <div data-selector='tagify-suggestions-wrapper' class=\"").concat(n.classNames.dropdownWrapper,'"></div>\n                </div>')},dropdownContent:function(n){var x=this.settings.templates,A=this.state.dropdown.suggestions;return"\n            ".concat(x.dropdownHeader.call(this,A),"\n            ").concat(n,"\n            ").concat(x.dropdownFooter.call(this,A),"\n        ")},dropdownItem:function(n){return"<div ".concat(this.getAttributes(n),"\n                    class='").concat(this.settings.classNames.dropdownItem," ").concat(n.class||"",'\'\n                    tabindex="0"\n                    role="option">').concat(n.mappedValue||n.value,"</div>")},dropdownHeader:function(n){return"<header data-selector='tagify-suggestions-header' class=\"".concat(this.settings.classNames.dropdownHeader,'"></header>')},dropdownFooter:function(n){var x=n.length-this.settings.dropdown.maxItems;return x>0?"<footer data-selector='tagify-suggestions-footer' class=\"".concat(this.settings.classNames.dropdownFooter,'">\n                ').concat(x," more items. Refine your search.\n            </footer>"):""},dropdownItemNoMatch:null};function F(n,x){(null==x||x>n.length)&&(x=n.length);for(var A=0,C=new Array(x);A<x;A++)C[A]=n[A];return C}function R(n,x){return null!=x&&"undefined"!=typeof Symbol&&x[Symbol.hasInstance]?!!x[Symbol.hasInstance](n):n instanceof x}function H(n,x){return function(n){if(Array.isArray(n))return n}(n)||function(n,x){var A=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=A){var C,k,L=[],j=!0,P=!1;try{for(A=A.call(n);!(j=(C=A.next()).done)&&(L.push(C.value),!x||L.length!==x);j=!0);}catch(n){P=!0,k=n}finally{try{j||null==A.return||A.return()}finally{if(P)throw k}}return L}}(n,x)||function(n,x){if(n){if("string"==typeof n)return F(n,x);var A=Object.prototype.toString.call(n).slice(8,-1);"Object"===A&&n.constructor&&(A=n.constructor.name);return"Map"===A||"Set"===A?Array.from(A):"Arguments"===A||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?F(n,x):void 0}}(n,x)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(n,x){(null==x||x>n.length)&&(x=n.length);for(var A=0,C=new Array(x);A<x;A++)C[A]=n[A];return C}function W(n,x,A){return x in n?Object.defineProperty(n,x,{value:A,enumerable:!0,configurable:!0,writable:!0}):n[x]=A,n}function U(n,x){return null!=x&&"undefined"!=typeof Symbol&&x[Symbol.hasInstance]?!!x[Symbol.hasInstance](n):n instanceof x}function q(n,x){return x=null!=x?x:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(x)):function(n,x){var A=Object.keys(n);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(n);x&&(C=C.filter((function(x){return Object.getOwnPropertyDescriptor(n,x).enumerable}))),A.push.apply(A,C)}return A}(Object(x)).forEach((function(A){Object.defineProperty(n,A,Object.getOwnPropertyDescriptor(x,A))})),n}function K(n){return function(n){if(Array.isArray(n))return B(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,x){if(n){if("string"==typeof n)return B(n,x);var A=Object.prototype.toString.call(n).slice(8,-1);"Object"===A&&n.constructor&&(A=n.constructor.name);return"Map"===A||"Set"===A?Array.from(A):"Arguments"===A||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?B(n,x):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Z={customBinding:function(){var n=this;this.customEventsList.forEach((function(x){n.on(x,n.settings.callbacks[x])}))},binding:function(){var n,x=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],A=this.settings,C=this.events.callbacks,k=x?"addEventListener":"removeEventListener";if(!this.state.mainEvents||!x){for(var L in this.state.mainEvents=x,x&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on("tagify.removeAllTags",this.removeAllTags.bind(this))),n=this.listeners.main=this.listeners.main||{keydown:["input",C.onKeydown.bind(this)],click:["scope",C.onClickScope.bind(this)],dblclick:"select"!=A.mode&&["scope",C.onDoubleClickScope.bind(this)],paste:["input",C.onPaste.bind(this)],drop:["input",C.onDrop.bind(this)],compositionstart:["input",C.onCompositionStart.bind(this)],compositionend:["input",C.onCompositionEnd.bind(this)]})n[L]&&this.DOM[n[L][0]][k](L,n[L][1]);var j=this.listeners.main.inputMutationObserver||new MutationObserver(C.onInputDOMChange.bind(this));j.disconnect(),"mix"==A.mode&&j.observe(this.DOM.input,{childList:!0}),this.events.bindOriginaInputListener.call(this)}},bindOriginaInputListener:function(n){var x=(n||0)+500;this.listeners.main&&(clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(this.events.callbacks.observeOriginalInputValue.bind(this),x))},bindGlobal:function(n){var x,A=this.events.callbacks,C=n?"removeEventListener":"addEventListener";if(this.listeners&&(n||!this.listeners.global)){this.listeners.global=this.listeners.global||[{type:this.isIE?"keydown":"input",target:this.DOM.input,cb:A[this.isIE?"onInputIE":"onInput"].bind(this)},{type:"keydown",target:window,cb:A.onWindowKeyDown.bind(this)},{type:"focusin",target:this.DOM.scope,cb:A.onFocusBlur.bind(this)},{type:"focusout",target:this.DOM.scope,cb:A.onFocusBlur.bind(this)},{type:"click",target:document,cb:A.onClickAnywhere.bind(this),useCapture:!0}];var k=!0,L=!1,j=void 0;try{for(var P,V=this.listeners.global[Symbol.iterator]();!(k=(P=V.next()).done);k=!0)(x=P.value).target[C](x.type,x.cb,!!x.useCapture)}catch(n){L=!0,j=n}finally{try{k||null==V.return||V.return()}finally{if(L)throw j}}}},unbindGlobal:function(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur:function(n){var x,A,C,k=b.call(this,n.target),L=v.call(this,n.target),j="focusin"==n.type,P="focusout"==n.type;null===(x=n.target)||void 0===x||x.closest(this.settings.classNames.tagTextSelector),k&&j&&!L&&this.toggleFocusClass(this.state.hasFocus=+new Date);var V=this.settings,z=n.target?this.trim(this.DOM.input.textContent):"",Z=null===(C=this.value)||void 0===C||null===(A=C[0])||void 0===A?void 0:A[V.tagTextProp],tt=V.dropdown.enabled>=0,et={relatedTarget:n.relatedTarget},it=this.state.actions.selectOption&&(tt||!V.dropdown.closeOnSelect),nt=this.state.actions.addNew&&tt;if(P){if(n.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate()}if(!it&&!nt)if(j||k?(this.state.hasFocus=+new Date,this.toggleFocusClass(this.state.hasFocus)):this.state.hasFocus=!1,"mix"!=V.mode){if(j){if(!V.focusable)return;var st=0===V.dropdown.enabled&&!this.state.dropdown.visible;return this.toggleFocusClass(!0),this.trigger("focus",et),void(!st||L&&"select"!==V.mode||this.dropdown.show(this.value.length?"":void 0))}if(P){if(this.trigger("blur",et),this.loading(!1),"select"==V.mode){if(this.value.length){var at=this.getTagElms()[0];z=this.trim(at.textContent)}Z===z&&(z="")}z&&!this.state.actions.selectOption&&V.addTagOnBlur&&V.addTagOn.includes("blur")&&this.addTags(z,!0)}k||(this.DOM.input.removeAttribute("style"),this.dropdown.hide())}else j?this.trigger("focus",et):P&&(this.trigger("blur",et),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart:function(n){this.state.composing=!0},onCompositionEnd:function(n){this.state.composing=!1},onWindowKeyDown:function(n){var x,A=this.settings,C=document.activeElement,k=b.call(this,C)&&this.DOM.scope.contains(document.activeElement),L=k&&C.hasAttribute("readonly");if(this.state.hasFocus||k&&!L){x=C.nextElementSibling;var j=n.target.classList.contains(A.classNames.tagX);switch(n.key){case"Backspace":A.readonly||this.state.editing||(this.removeTags(C),(x||this.DOM.input).focus());break;case"Enter":if(j)return void this.removeTags(n.target.parentNode);A.a11y.focusableTags&&v.call(this,C)&&setTimeout(this.editTag.bind(this),0,C);break;case"ArrowDown":this.state.dropdown.visible||"mix"==A.mode||this.dropdown.show()}}},onKeydown:function(n){var x=this,A=this.settings;if(!this.state.composing&&A.userInput){"select"==A.mode&&A.enforceWhitelist&&this.value.length&&"Tab"!=n.key&&n.preventDefault();var C=this.trim(n.target.textContent);this.trigger("keydown",{event:n}),A.hooks.beforeKeyDown(n,{tagify:this}).then((function(k){if("mix"==A.mode){switch(n.key){case"Left":case"ArrowLeft":x.state.actions.ArrowLeft=!0;break;case"Delete":case"Backspace":if(x.state.editing)return;var j=document.getSelection(),P="Delete"==n.key&&j.anchorOffset==(j.anchorNode.length||0),V=j.anchorNode.previousSibling,z=1==j.anchorNode.nodeType||!j.anchorOffset&&V&&1==V.nodeType&&j.anchorNode.previousSibling;r(x.DOM.input.innerHTML);var Z,tt,et,it=x.getTagElms(),nt=1===j.anchorNode.length&&j.anchorNode.nodeValue==String.fromCharCode(8203);if("edit"==A.backspace&&z)return Z=1==j.anchorNode.nodeType?null:j.anchorNode.previousElementSibling,setTimeout(x.editTag.bind(x),0,Z),void n.preventDefault();if(f()&&U(z,Element))return et=d(z),z.hasAttribute("readonly")||z.remove(),x.DOM.input.focus(),void setTimeout((function(){T(et),x.DOM.input.click()}));if("BR"==j.anchorNode.nodeName)return;if((P||z)&&1==j.anchorNode.nodeType?tt=0==j.anchorOffset?P?it[0]:null:it[Math.min(it.length,j.anchorOffset)-1]:P?tt=j.anchorNode.nextElementSibling:U(z,Element)&&(tt=z),3==j.anchorNode.nodeType&&!j.anchorNode.nodeValue&&j.anchorNode.previousElementSibling&&n.preventDefault(),(z||P)&&!A.backspace)return void n.preventDefault();if("Range"!=j.type&&!j.anchorOffset&&j.anchorNode==x.DOM.input&&"Delete"!=n.key)return void n.preventDefault();if("Range"!=j.type&&tt&&tt.hasAttribute("readonly"))return void T(d(tt));"Delete"==n.key&&nt&&y(j.anchorNode.nextSibling)&&x.removeTags(j.anchorNode.nextSibling),clearTimeout(L),L=setTimeout((function(){var n=document.getSelection();r(x.DOM.input.innerHTML),!P&&n.anchorNode.previousSibling,x.value=[].map.call(it,(function(n,A){var C=y(n);if(n.parentNode||C.readonly)return C;x.trigger("remove",{tag:n,index:A,data:C})})).filter((function(n){return n}))}),20)}return!0}var st="manual"==A.dropdown.position;switch(n.key){case"Backspace":"select"==A.mode&&A.enforceWhitelist&&x.value.length?x.removeTags():x.state.dropdown.visible&&"manual"!=A.dropdown.position||""!=n.target.textContent&&8203!=C.charCodeAt(0)||(!0===A.backspace?x.removeTags():"edit"==A.backspace&&setTimeout(x.editTag.bind(x),0));break;case"Esc":case"Escape":if(x.state.dropdown.visible)return;n.target.blur();break;case"Down":case"ArrowDown":x.state.dropdown.visible||x.dropdown.show();break;case"ArrowRight":var at=x.state.inputSuggestion||x.state.ddItemData;if(at&&A.autoComplete.rightKey)return void x.addTags([at],!0);break;case"Tab":var ot="select"==A.mode;if(!C||ot)return!0;n.preventDefault();case"Enter":if(x.state.dropdown.visible&&!st)return;n.preventDefault(),setTimeout((function(){x.state.dropdown.visible&&!st||x.state.actions.selectOption||!A.addTagOn.includes(n.key.toLowerCase())||x.addTags(C,!0)}))}})).catch((function(n){return n}))}},onInput:function(n){this.postUpdate();var x=this.settings;if("mix"==x.mode)return this.events.callbacks.onMixTagsInput.call(this,n);var A=this.input.normalize.call(this,void 0,{trim:!1}),C=A.length>=x.dropdown.enabled,k={value:A,inputElm:this.DOM.input},L=this.validateTag({value:A});"select"==x.mode&&this.toggleScopeValidation(L),k.isValid=L,this.state.inputText!=A&&(this.input.set.call(this,A,!1),-1!=A.search(x.delimiters)?this.addTags(A)&&this.input.set.call(this):x.dropdown.enabled>=0&&this.dropdown[C?"show":"hide"](A),this.trigger("input",k))},onMixTagsInput:function(n){var x,A,C,k,L,j,P,V,z=this,Z=this.settings,tt=this.value.length,et=this.getTagElms(),it=document.createDocumentFragment(),nt=window.getSelection().getRangeAt(0),st=[].map.call(et,(function(n){return y(n).value}));if("deleteContentBackward"==n.inputType&&f()&&this.events.callbacks.onKeydown.call(this,{target:n.target,key:"Backspace"}),O(this.getTagElms()),this.value.slice().forEach((function(n){n.readonly&&!st.includes(n.value)&&it.appendChild(z.createTagElem(n))})),it.childNodes.length&&(nt.insertNode(it),this.setRangeAtStartEnd(!1,it.lastChild)),et.length!=tt)return this.value=[].map.call(this.getTagElms(),(function(n){return y(n)})),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(j=window.getSelection()).rangeCount>0&&3==j.anchorNode.nodeType){if((nt=j.getRangeAt(0).cloneRange()).collapse(!0),nt.setStart(j.focusNode,0),C=(x=nt.toString().slice(0,nt.endOffset)).split(Z.pattern).length-1,(A=x.match(Z.pattern))&&(k=x.slice(x.lastIndexOf(A[A.length-1]))),k){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:k.match(Z.pattern)[0],value:k.replace(Z.pattern,"")},this.state.tag.baseOffset=j.baseOffset-this.state.tag.value.length,V=this.state.tag.value.match(Z.delimiters))return this.state.tag.value=this.state.tag.value.replace(Z.delimiters,""),this.state.tag.delimiters=V[0],this.addTags(this.state.tag.value,Z.dropdown.clearOnSelect),void this.dropdown.hide();L=this.state.tag.value.length>=Z.dropdown.enabled;try{P=(P=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&P.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(n){}(P||C<this.state.mixMode.matchedPatternCount)&&(L=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=C}setTimeout((function(){z.update({withoutChangeEvent:!0}),z.trigger("input",g({},z.state.tag,{textContent:z.DOM.input.textContent})),z.state.tag&&z.dropdown[L?"show":"hide"](z.state.tag.value)}),10)},onInputIE:function(n){var x=this;setTimeout((function(){x.events.callbacks.onInput.call(x,n)}))},observeOriginalInputValue:function(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere:function(n){n.target==this.DOM.scope||this.DOM.scope.contains(n.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1,n.target.closest(".tagify__dropdown")&&n.target.closest(".tagify__dropdown").__tagify!=this&&this.dropdown.hide())},onClickScope:function(n){var x=this.settings,A=n.target.closest("."+x.classNames.tag),C=n.target===this.DOM.scope,k=+new Date-this.state.hasFocus;if(C&&"select"!=x.mode)this.DOM.input.focus();else{if(!n.target.classList.contains(x.classNames.tagX))return A&&!this.state.editing?(this.trigger("click",{tag:A,index:this.getNodeIndex(A),data:y(A),event:n}),void(1!==x.editTags&&1!==x.editTags.clicks&&"select"!=x.mode||this.events.callbacks.onDoubleClickScope.call(this,n))):void(n.target==this.DOM.input&&("mix"==x.mode&&this.fixFirefoxLastTagNoCaret(),k>500||!x.focusable)?this.state.dropdown.visible?this.dropdown.hide():0===x.dropdown.enabled&&"mix"!=x.mode&&this.dropdown.show(this.value.length?"":void 0):"select"!=x.mode||0!==x.dropdown.enabled||this.state.dropdown.visible||(this.events.callbacks.onDoubleClickScope.call(this,q(function(n){for(var x=1;x<arguments.length;x++){var A=null!=arguments[x]?arguments[x]:{},C=Object.keys(A);"function"==typeof Object.getOwnPropertySymbols&&(C=C.concat(Object.getOwnPropertySymbols(A).filter((function(n){return Object.getOwnPropertyDescriptor(A,n).enumerable})))),C.forEach((function(x){W(n,x,A[x])}))}return n}({},n),{target:this.getTagElms()[0]})),!x.userInput&&this.dropdown.show()));this.removeTags(n.target.parentNode)}},onPaste:function(n){var x=this;n.preventDefault();var A,C,k,L=this.settings;if("select"==L.mode&&L.enforceWhitelist||!L.userInput)return!1;L.readonly||(C=n.clipboardData||window.clipboardData,k=C.getData("Text"),L.hooks.beforePaste(n,{tagify:this,pastedText:k,clipboardData:C}).then((function(L){void 0===L&&(L=k),L&&(x.injectAtCaret(L,window.getSelection().getRangeAt(0)),"mix"==x.settings.mode?x.events.callbacks.onMixTagsInput.call(x,n):x.settings.pasteAsTags?A=x.addTags(x.state.inputText+L,!0):(x.state.inputText=L,x.dropdown.show(L))),x.trigger("paste",{event:n,pastedText:k,clipboardData:C,tagsElems:A})})).catch((function(n){return n})))},onDrop:function(n){n.preventDefault()},onEditTagInput:function(n,x){var A,C=n.closest("."+this.settings.classNames.tag),k=this.getNodeIndex(C),L=y(C),j=this.input.normalize.call(this,n),P=(W(A={},this.settings.tagTextProp,j),W(A,"__tagId",L.__tagId),A),V=this.validateTag(P);this.editTagChangeDetected(g(L,P))||!0!==n.originalIsValid||(V=!0),C.classList.toggle(this.settings.classNames.tagInvalid,!0!==V),L.__isValid=V,C.title=!0===V?L.title||L.value:V,j.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=j),this.dropdown.show(j)),this.trigger("edit:input",{tag:C,index:k,data:g({},this.value[k],{newValue:j}),event:x})},onEditTagPaste:function(n,x){var A=(x.clipboardData||window.clipboardData).getData("Text");x.preventDefault();var C=w(A);this.setRangeAtStartEnd(!1,C)},onEditTagClick:function(n,x){this.events.callbacks.onClickScope.call(this,x)},onEditTagFocus:function(n){this.state.editing={scope:n,input:n.querySelector("[contenteditable]")}},onEditTagBlur:function(n,x){var A=v.call(this,x.relatedTarget);if("select"==this.settings.mode&&A&&x.relatedTarget.contains(x.target))this.dropdown.hide();else if(this.state.editing&&(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(n))){var C,k,L,j=this.settings,P=n.closest("."+j.classNames.tag),V=y(P),z=this.input.normalize.call(this,n),Z=(W(C={},j.tagTextProp,z),W(C,"__tagId",V.__tagId),C),tt=V.__originalData,et=this.editTagChangeDetected(g(V,Z)),it=this.validateTag(Z);if(z)if(et){var nt;if(k=this.hasMaxTags(),L=g({},tt,(W(nt={},j.tagTextProp,this.trim(z)),W(nt,"__isValid",it),nt)),j.transformTag.call(this,L,tt),!0!==(it=(!k||!0===tt.__isValid)&&this.validateTag(L))){if(this.trigger("invalid",{data:L,tag:P,message:it}),j.editTags.keepInvalid)return;j.keepInvalidTags?L.__isValid=it:L=tt}else j.keepInvalidTags&&(delete L.title,delete L["aria-invalid"],delete L.class);this.onEditTagDone(P,L)}else this.onEditTagDone(P,tt);else this.onEditTagDone(P)}},onEditTagkeydown:function(n,x){if(!this.state.composing)switch(this.trigger("edit:keydown",{event:n}),n.key){case"Esc":case"Escape":this.state.editing=!1,!x.__tagifyTagData.__originalData.value?x.remove():x.parentNode.replaceChild(x.__tagifyTagData.__originalHTML,x);break;case"Enter":case"Tab":n.preventDefault();setTimeout((function(){return n.target.blur()}),0)}},onDoubleClickScope:function(n){var x,A,C=n.target.closest("."+this.settings.classNames.tag),k=y(C),L=this.settings;C&&!1!==k.editable&&(x=C.classList.contains(this.settings.classNames.tagEditing),A=C.hasAttribute("readonly"),L.readonly||x||A||!this.settings.editTags||!L.userInput||(this.events.callbacks.onEditTagFocus.call(this,C),this.editTag(C)),this.toggleFocusClass(!0),"select"!=L.mode&&this.trigger("dblclick",{tag:C,index:this.getNodeIndex(C),data:y(C)}))},onInputDOMChange:function(n){var x=this;n.forEach((function(n){n.addedNodes.forEach((function(n){if("<div><br></div>"==n.outerHTML)n.replaceWith(document.createElement("br"));else if(1==n.nodeType&&n.querySelector(x.settings.classNames.tagSelector)){var A,C=document.createTextNode("");3==n.childNodes[0].nodeType&&"BR"!=n.previousSibling.nodeName&&(C=document.createTextNode("\n")),(A=n).replaceWith.apply(A,K([C].concat(K(K(n.childNodes).slice(0,-1))))),T(C)}else if(v.call(x,n)){var k;if(3!=(null===(k=n.previousSibling)||void 0===k?void 0:k.nodeType)||n.previousSibling.textContent||n.previousSibling.remove(),n.previousSibling&&"BR"==n.previousSibling.nodeName){n.previousSibling.replaceWith("\n​");for(var L=n.nextSibling,j="";L;)j+=L.textContent,L=L.nextSibling;j.trim()&&T(n.previousSibling)}else n.previousSibling&&!y(n.previousSibling)||n.before("​")}})),n.removedNodes.forEach((function(n){n&&"BR"==n.nodeName&&v.call(x,A)&&(x.removeTags(A),x.fixFirefoxLastTagNoCaret())}))}));var A=this.DOM.input.lastChild;A&&""==A.nodeValue&&A.remove(),A&&"BR"==A.nodeName||this.DOM.input.appendChild(document.createElement("br"))}}};function X(n,x){(null==x||x>n.length)&&(x=n.length);for(var A=0,C=new Array(x);A<x;A++)C[A]=n[A];return C}function J(n,x,A){return x in n?Object.defineProperty(n,x,{value:A,enumerable:!0,configurable:!0,writable:!0}):n[x]=A,n}function G(n,x){return null!=x&&"undefined"!=typeof Symbol&&x[Symbol.hasInstance]?!!x[Symbol.hasInstance](n):n instanceof x}function $(n){for(var x=1;x<arguments.length;x++){var A=null!=arguments[x]?arguments[x]:{},C=Object.keys(A);"function"==typeof Object.getOwnPropertySymbols&&(C=C.concat(Object.getOwnPropertySymbols(A).filter((function(n){return Object.getOwnPropertyDescriptor(A,n).enumerable})))),C.forEach((function(x){J(n,x,A[x])}))}return n}function Q(n){return function(n){if(Array.isArray(n))return X(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,x){if(n){if("string"==typeof n)return X(n,x);var A=Object.prototype.toString.call(n).slice(8,-1);"Object"===A&&n.constructor&&(A=n.constructor.name);return"Map"===A||"Set"===A?Array.from(A):"Arguments"===A||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?X(n,x):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(n,A){if(!n){x.warn("input element not found",n);var C=new Proxy(this,{get:function(){return function(){return C}}});return C}if(n.__tagify)return x.warn("input element is already Tagified - Same instance is returned.",n),n.__tagify;var k;g(this,function(n){var A=document.createTextNode(""),C={};function s(n,x,C){C&&x.split(/\s+/g).forEach((function(x){return A[n+"EventListener"].call(A,x,C)}))}return{removeAllCustomListeners:function(){Object.entries(C).forEach((function(n){var x=H(n,2),A=x[0];x[1].forEach((function(n){return s("remove",A,n)}))})),C={}},off:function(n,x){return n&&(x?s("remove",n,x):n.split(/\s+/g).forEach((function(n){var x;null===(x=C[n])||void 0===x||x.forEach((function(x){return s("remove",n,x)})),delete C[n]}))),this},on:function(n,x){return x&&"function"==typeof x&&(n.split(/\s+/g).forEach((function(n){Array.isArray(C[n])?C[n].push(x):C[n]=[x]})),s("add",n,x)),this},trigger:function(C,k,L){var j;if(L=L||{cloneData:!0},C)if(n.settings.isJQueryPlugin)"remove"==C&&(C="removeTag"),jQuery(n.DOM.originalInput).triggerHandler(C,[k]);else{try{var P="object"==typeof k?k:{value:k};if((P=L.cloneData?g({},P):P).tagify=this,k.event&&(P.event=this.cloneEvent(k.event)),R(k,Object))for(var V in k)R(k[V],HTMLElement)&&(P[V]=k[V]);j=new CustomEvent(C,{detail:P})}catch(n){x.warn(n)}A.dispatchEvent(j)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,A=A||{},this.getPersistedData=(k=A.id,function(n){var x,A="/"+n;if(1==localStorage.getItem(P+k+"/v",1))try{x=JSON.parse(localStorage[P+k+A])}catch(n){}return x}),this.setPersistedData=function(n){return n?(localStorage.setItem(P+n+"/v",1),function(x,A){var C="/"+A,k=JSON.stringify(x);x&&A&&(localStorage.setItem(P+n+C,k),dispatchEvent(new Event("storage")))}):function(){}}(A.id),this.clearPersistedData=function(n){return function(x){var A=P+"/"+n+"/";if(x)localStorage.removeItem(A+x);else for(var C in localStorage)C.includes(A)&&localStorage.removeItem(C)}}(A.id),this.applySettings(n,A),this.state={inputText:"",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(n),_.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),n.autofocus&&this.DOM.input.focus(),n.__tagify=this}Y.prototype={_dropdown:j,placeCaretAfterNode:T,getSetTagData:y,helpers:{sameStr:s,removeCollectionProp:a,omit:o,isObject:u,parseHTML:l,escapeHTML:c,extend:g,concatWithoutDups:h,getUID:m,isNodeTag:v},customEventsList:["change","add","remove","invalid","input","paste","click","keydown","focus","blur","edit:input","edit:beforeUpdate","edit:updated","edit:start","edit:keydown","dropdown:show","dropdown:hide","dropdown:select","dropdown:updated","dropdown:noMatch","dropdown:scroll"],dataProps:["__isValid","__removed","__originalData","__originalHTML","__tagId"],trim:function(n){return this.settings.trim&&n&&"string"==typeof n?n.trim():n},parseHTML:l,templates:z,parseTemplate:function(n,x){return l((n=this.settings.templates[n]||n).apply(this,x))},set whitelist(n){var x=n&&Array.isArray(n);this.settings.whitelist=x?n:[],this.setPersistedData(x?n:[],"whitelist")},get whitelist(){return this.settings.whitelist},set userInput(n){this.settings.userInput=!!n,this.setContentEditable(!!n)},get userInput(){return this.settings.userInput},generateClassSelectors:function(n){var e=function(x){var A=x;Object.defineProperty(n,A+"Selector",{get:function(){return"."+this[A].split(" ")[0]}})};for(var x in n)e(x)},applySettings:function(n,x){var C,k;A.templates=this.templates;var L=g({},A,"mix"==x.mode?{dropdown:{position:"text"}}:{}),j=this.settings=g({},L,x);if(j.disabled=n.hasAttribute("disabled"),j.readonly=j.readonly||n.hasAttribute("readonly"),j.placeholder=c(n.getAttribute("placeholder")||j.placeholder||""),j.required=n.hasAttribute("required"),this.generateClassSelectors(j.classNames),void 0===j.dropdown.includeSelectedTags&&(j.dropdown.includeSelectedTags=j.duplicates),this.isIE&&(j.autoComplete=!1),["whitelist","blacklist"].forEach((function(x){var A=n.getAttribute("data-"+x);A&&G(A=A.split(j.delimiters),Array)&&(j[x]=A)})),"autoComplete"in x&&!u(x.autoComplete)&&(j.autoComplete=A.autoComplete,j.autoComplete.enabled=x.autoComplete),"mix"==j.mode&&(j.pattern=j.pattern||/@/,j.autoComplete.rightKey=!0,j.delimiters=x.delimiters||null,j.tagTextProp&&!j.dropdown.searchKeys.includes(j.tagTextProp)&&j.dropdown.searchKeys.push(j.tagTextProp)),n.pattern)try{j.pattern=new RegExp(n.pattern)}catch(n){}if(j.delimiters){j._delimiters=j.delimiters;try{j.delimiters=new RegExp(this.settings.delimiters,"g")}catch(n){}}j.disabled&&(j.userInput=!1),this.TEXTS=$({},V,j.texts||{}),("select"!=j.mode||(null===(C=x.dropdown)||void 0===C?void 0:C.enabled))&&j.userInput||(j.dropdown.enabled=0),j.dropdown.appendTarget=(null===(k=x.dropdown)||void 0===k?void 0:k.appendTarget)||document.body;var P=this.getPersistedData("whitelist");Array.isArray(P)&&(this.whitelist=Array.isArray(j.whitelist)?h(j.whitelist,P):P)},getAttributes:function(n){var x,A=this.getCustomAttributes(n),C="";for(x in A)C+=" "+x+(void 0!==n[x]?'="'.concat(A[x],'"'):"");return C},getCustomAttributes:function(n){if(!u(n))return"";var x,A={};for(x in n)"__"!=x.slice(0,2)&&"class"!=x&&n.hasOwnProperty(x)&&void 0!==n[x]&&(A[x]=c(n[x]));return A},setStateSelection:function(){var n=window.getSelection(),x={anchorOffset:n.anchorOffset,anchorNode:n.anchorNode,range:n.getRangeAt&&n.rangeCount&&n.getRangeAt(0)};return this.state.selection=x,x},getCSSVars:function(){var n,x,A,C=getComputedStyle(this.DOM.scope,null);this.CSSVars={tagHideTransition:(n=function(n){if(!n)return{};var x=(n=n.trim().split(" ")[0]).split(/\d+/g).filter((function(n){return n})).pop().trim();return{value:+n.split(x).filter((function(n){return n}))[0].trim(),unit:x}}((A="tag-hide-transition",C.getPropertyValue("--"+A))),x=n.value,"s"==n.unit?1e3*x:x)}},build:function(n){var x=this.DOM,A=n.closest("label");this.settings.mixMode.integrated?(x.originalInput=null,x.scope=n,x.input=n):(x.originalInput=n,x.originalInput_tabIndex=n.tabIndex,x.scope=this.parseTemplate("wrapper",[n,this.settings]),x.input=x.scope.querySelector(this.settings.classNames.inputSelector),n.parentNode.insertBefore(x.scope,n),n.tabIndex=-1),A&&A.setAttribute("for","")},destroy:function(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),this.removeAllCustomListeners(),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues:function(n){var x,A=this.settings;if(this.state.blockChangeEvent=!0,void 0===n){var C=this.getPersistedData("value");n=C&&!this.DOM.originalInput.value?C:A.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),n)if("mix"==A.mode)this.parseMixTags(n),(x=this.DOM.input.lastChild)&&"BR"==x.tagName||this.DOM.input.insertAdjacentHTML("beforeend","<br>");else{try{G(JSON.parse(n),Array)&&(n=JSON.parse(n))}catch(n){}this.addTags(n,!0).forEach((function(n){return n&&n.classList.add(A.classNames.tagNoAnimation)}))}else this.postUpdate();this.state.lastOriginalValueReported=A.mixMode.integrated?"":this.DOM.originalInput.value},cloneEvent:function(n){var x={};for(var A in n)"path"!=A&&(x[A]=n[A]);return x},loading:function(n){return this.state.isLoading=n,this.DOM.scope.classList[n?"add":"remove"](this.settings.classNames.scopeLoading),this},tagLoading:function(n,x){return n&&n.classList[x?"add":"remove"](this.settings.classNames.tagLoading),this},toggleClass:function(n,x){"string"==typeof n&&this.DOM.scope.classList.toggle(n,x)},toggleScopeValidation:function(n){var x=!0===n||void 0===n;!this.settings.required&&n&&n===this.TEXTS.empty&&(x=!0),this.toggleClass(this.settings.classNames.tagInvalid,!x),this.DOM.scope.title=x?"":n},toggleFocusClass:function(n){this.toggleClass(this.settings.classNames.focus,!!n)},setPlaceholder:function(n){var x=this;["data","aria"].forEach((function(A){return x.DOM.input.setAttribute("".concat(A,"-placeholder"),n)}))},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var n=this.DOM.originalInput,x=this.state.lastOriginalValueReported!==n.value,A=new CustomEvent("change",{bubbles:!0});x&&(this.state.lastOriginalValueReported=n.value,A.simulated=!0,n._valueTracker&&n._valueTracker.setValue(Math.random()),n.dispatchEvent(A),this.trigger("change",this.state.lastOriginalValueReported),n.value=this.state.lastOriginalValueReported)}},events:Z,fixFirefoxLastTagNoCaret:function(){},setRangeAtStartEnd:function(n,x){if(x){n="number"==typeof n?n:!!n,x=x.lastChild||x;var A=document.getSelection();if(G(A.focusNode,Element)&&!this.DOM.input.contains(A.focusNode))return!0;try{A.rangeCount>=1&&["Start","End"].forEach((function(C){return A.getRangeAt(0)["set"+C](x,n||x.length)}))}catch(n){console.warn(n)}}},insertAfterTag:function(n,x){if(x=x||this.settings.mixMode.insertAfterTag,n&&n.parentNode&&x)return x="string"==typeof x?document.createTextNode(x):x,n.parentNode.insertBefore(x,n.nextSibling),x},editTagChangeDetected:function(n){var x=n.__originalData;for(var A in x)if(!this.dataProps.includes(A)&&n[A]!=x[A])return!0;return!1},getTagTextNode:function(n){return n.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode:function(n,x){this.getTagTextNode(n).innerHTML=c(x)},editTag:function(n,A){var C=this;n=n||this.getLastTag(),A=A||{};var k=this.settings,L=this.getTagTextNode(n),j=this.getNodeIndex(n),P=y(n),V=this.events.callbacks,z=!0,Z="select"==k.mode;if(!Z&&this.dropdown.hide(),L){if(!G(P,Object)||!("editable"in P)||P.editable)return P=y(n,{__originalData:g({},P),__originalHTML:n.cloneNode(!0)}),y(P.__originalHTML,P.__originalData),L.setAttribute("contenteditable",!0),n.classList.add(k.classNames.tagEditing),L.addEventListener("click",V.onEditTagClick.bind(this,n)),L.addEventListener("blur",V.onEditTagBlur.bind(this,this.getTagTextNode(n))),L.addEventListener("input",V.onEditTagInput.bind(this,L)),L.addEventListener("paste",V.onEditTagPaste.bind(this,L)),L.addEventListener("keydown",(function(x){return V.onEditTagkeydown.call(C,x,n)})),L.addEventListener("compositionstart",V.onCompositionStart.bind(this)),L.addEventListener("compositionend",V.onCompositionEnd.bind(this)),A.skipValidation||(z=this.editTagToggleValidity(n)),L.originalIsValid=z,this.trigger("edit:start",{tag:n,index:j,data:P,isValid:z}),L.focus(),!Z&&this.setRangeAtStartEnd(!1,L),0===k.dropdown.enabled&&!Z&&this.dropdown.show(),this.state.hasFocus=!0,this}else x.warn("Cannot find element in Tag template: .",k.classNames.tagTextSelector)},editTagToggleValidity:function(n,A){var C;if(A=A||y(n))return(C=!("__isValid"in A)||!0===A.__isValid)||this.removeTagsFromValue(n),this.update(),n.classList.toggle(this.settings.classNames.tagNotAllowed,!C),A.__isValid=C,A.__isValid;x.warn("tag has no data: ",n,A)},onEditTagDone:function(n,x){n=n||this.state.editing.scope,x=x||{};var A,C,k={tag:n,index:this.getNodeIndex(n),previousData:y(n),data:x},L=this.settings;this.trigger("edit:beforeUpdate",k,{cloneData:!1}),this.state.editing=!1,delete x.__originalData,delete x.__originalHTML,n&&(void 0!==(C=x[L.tagTextProp])?null===(A=(C+="").trim)||void 0===A?void 0:A.call(C):L.tagTextProp in x?void 0:x.value)?(n=this.replaceTag(n,x),this.editTagToggleValidity(n,x),L.a11y.focusableTags?n.focus():"select"!=L.mode&&T(n)):n&&this.removeTags(n),this.trigger("edit:updated",k),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag:function(n,x){x&&""!==x.value&&void 0!==x.value||(x=n.__tagifyTagData),x.__isValid&&1!=x.__isValid&&g(x,this.getInvalidTagAttrs(x,x.__isValid));var A=this.createTagElem(x);return n.parentNode.replaceChild(A,n),this.updateValueByDOMTags(),A},updateValueByDOMTags:function(){var n=this;this.value.length=0,[].forEach.call(this.getTagElms(),(function(x){x.classList.contains(n.settings.classNames.tagNotAllowed.split(" ")[0])||n.value.push(y(x))})),this.update()},injectAtCaret:function(n,x){var A;if(!(x=x||(null===(A=this.state.selection)||void 0===A?void 0:A.range))&&n)return this.appendMixTags(n),this;var C=w(n,x);return this.setRangeAtStartEnd(!1,C),this.updateValueByDOMTags(),this.update(),this},input:{set:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",x=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],A=this.settings.dropdown.closeOnSelect;this.state.inputText=n,x&&(this.DOM.input.innerHTML=c(""+n)),!n&&A&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw:function(){return this.DOM.input.textContent},validate:function(){var n=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!n),n},normalize:function(n,x){var A=n||this.DOM.input,C=[];A.childNodes.forEach((function(n){return 3==n.nodeType&&C.push(n.nodeValue)})),C=C.join("\n");try{C=C.replace(/(?:\r\n|\r|\n)/g,this.settings.delimiters.source.charAt(0))}catch(n){}return C=C.replace(/\s/g," "),(null==x?void 0:x.trim)?this.trim(C):C},autocomplete:{suggest:function(n){if(this.settings.autoComplete.enabled){"object"!=typeof(n=n||{value:""})&&(n={value:n});var x=this.dropdown.getMappedValue(n);if("number"!=typeof x){var A=this.state.inputText.toLowerCase(),C=x.substr(0,this.state.inputText.length).toLowerCase(),k=x.substring(this.state.inputText.length);x&&this.state.inputText&&C==A?(this.DOM.input.setAttribute("data-suggest",k),this.state.inputSuggestion=n):(this.DOM.input.removeAttribute("data-suggest"),delete this.state.inputSuggestion)}}},set:function(n){var x=this.DOM.input.getAttribute("data-suggest"),A=n||(x?this.state.inputText+x:null);return!!A&&("mix"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+A)):(this.input.set.call(this,A),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx:function(n){return this.value.findIndex((function(x){return x.__tagId==(n||{}).__tagId}))},getNodeIndex:function(n){var x=0;if(n)for(;n=n.previousElementSibling;)x++;return x},getTagElms:function(){for(var n=arguments.length,x=new Array(n),A=0;A<n;A++)x[A]=arguments[A];var C="."+Q(this.settings.classNames.tag.split(" ")).concat(Q(x)).join(".");return[].slice.call(this.DOM.scope.querySelectorAll(C))},getLastTag:function(){var n=this.settings.classNames,x=this.DOM.scope.querySelectorAll("".concat(n.tagSelector,":not(.").concat(n.tagHide,"):not([readonly])"));return x[x.length-1]},isTagDuplicate:function(n,x,A){var C=0;if("select"==this.settings.mode)return!1;var k=!0,L=!1,j=void 0;try{for(var P,V=this.value[Symbol.iterator]();!(k=(P=V.next()).done);k=!0){var z=P.value;s(this.trim(""+n),z.value,x)&&A!=z.__tagId&&C++}}catch(n){L=!0,j=n}finally{try{k||null==V.return||V.return()}finally{if(L)throw j}}return C},getTagIndexByValue:function(n){var x=this,A=[],C=this.settings.dropdown.caseSensitive;return this.getTagElms().forEach((function(k,L){k.__tagifyTagData&&s(x.trim(k.__tagifyTagData.value),n,C)&&A.push(L)})),A},getTagElmByValue:function(n){var x=this.getTagIndexByValue(n)[0];return this.getTagElms()[x]},flashTag:function(n){var x=this;n&&(n.classList.add(this.settings.classNames.tagFlash),setTimeout((function(){n.classList.remove(x.settings.classNames.tagFlash)}),100))},isTagBlacklisted:function(n){return n=this.trim(n.toLowerCase()),this.settings.blacklist.filter((function(x){return(""+x).toLowerCase()==n})).length},isTagWhitelisted:function(n){return!!this.getWhitelistItem(n)},getWhitelistItem:function(n,x,A){x=x||"value";var C,k=this.settings;return(A=A||k.whitelist).some((function(A){var L="object"==typeof A?A[x]||A.value:A;if(s(L,n,k.dropdown.caseSensitive,k.trim))return C="object"==typeof A?A:{value:A},!0})),C||"value"!=x||"value"==k.tagTextProp||(C=this.getWhitelistItem(n,k.tagTextProp,A)),C},validateTag:function(n){var x=this.settings,A="value"in n?"value":x.tagTextProp,C=this.trim(n[A]+"");return(n[A]+"").trim()?"mix"!=x.mode&&x.pattern&&G(x.pattern,RegExp)&&!x.pattern.test(C)?this.TEXTS.pattern:!x.duplicates&&this.isTagDuplicate(C,x.dropdown.caseSensitive,n.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(C)||x.enforceWhitelist&&!this.isTagWhitelisted(C)?this.TEXTS.notAllowed:!x.validate||x.validate(n):this.TEXTS.empty},getInvalidTagAttrs:function(n,x){return{"aria-invalid":!0,class:"".concat(n.class||""," ").concat(this.settings.classNames.tagNotAllowed).trim(),title:x}},hasMaxTags:function(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly:function(n,x){var A=this.settings;this.DOM.scope.contains(document.activeElement)&&document.activeElement.blur(),A[x||"readonly"]=n,this.DOM.scope[(n?"set":"remove")+"Attribute"](x||"readonly",!0),this.settings.userInput=!0,this.setContentEditable(!n)},setContentEditable:function(n){this.DOM.input.contentEditable=n,this.DOM.input.tabIndex=n?0:-1},setDisabled:function(n){this.setReadonly(n,"disabled")},normalizeTags:function(n){var x=this,A=this.settings,C=A.whitelist,k=A.delimiters,L=A.mode,j=A.tagTextProp,P=[],V=!!C&&G(C[0],Object),z=Array.isArray(n),Z=z&&n[0].value,h=function(n){return(n+"").split(k).reduce((function(n,A){var C,k=x.trim(A);return k&&n.push((J(C={},j,k),J(C,"value",k),C)),n}),[])};if("number"==typeof n&&(n=n.toString()),"string"==typeof n){if(!n.trim())return[];n=h(n)}else z&&(n=n.reduce((function(n,A){if(u(A)){var C=g({},A);C[j]=x.trim(C[j]),C[j]&&n.push(C)}else if(A){var k;(k=n).push.apply(k,Q(h(A)))}return n}),[]));return V&&!Z&&(n.forEach((function(n){var A=P.map((function(n){return n.value})),C=x.dropdown.filterListItems.call(x,n[j],{exact:!0});x.settings.duplicates||(C=C.filter((function(n){return!A.includes(n.value)})));var k=C.length>1?x.getWhitelistItem(n[j],j,C):C[0];k&&G(k,Object)?P.push(k):"mix"!=L&&(null==n.value&&(n.value=n[j]),P.push(n))})),P.length&&(n=P)),n},parseMixTags:function(n){var x=this,A=this.settings,C=A.mixTagsInterpolator,k=A.duplicates,L=A.transformTag,j=A.enforceWhitelist,P=A.maxTags,V=A.tagTextProp,z=[];n=n.split(C[0]).map((function(n,A){var Z,tt,et,it=n.split(C[1]),nt=it[0],st=z.length==P;try{if(nt==+nt)throw Error;tt=JSON.parse(nt)}catch(n){tt=x.normalizeTags(nt)[0]||{value:nt}}if(L.call(x,tt),st||!(it.length>1)||j&&!x.isTagWhitelisted(tt.value)||!k&&x.isTagDuplicate(tt.value)){if(n)return A?C[0]+n:n}else tt[Z=tt[V]?V:"value"]=x.trim(tt[Z]),et=x.createTagElem(tt),z.push(tt),et.classList.add(x.settings.classNames.tagNoAnimation),it[0]=et.outerHTML,x.value.push(tt);return it.join("")})).join(""),this.DOM.input.innerHTML=n,this.DOM.input.appendChild(document.createTextNode("")),this.DOM.input.normalize();var Z=this.getTagElms();return Z.forEach((function(n,x){return y(n,z[x])})),this.update({withoutChangeEvent:!0}),O(Z,this.state.hasFocus),n},replaceTextWithNode:function(n,x){if(this.state.tag||x){x=x||this.state.tag.prefix+this.state.tag.value;var A,C,k=this.state.selection||window.getSelection(),L=k.anchorNode,j=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return L.splitText(k.anchorOffset-j),-1==(A=L.nodeValue.lastIndexOf(x))||(C=L.splitText(A),n&&L.parentNode.replaceChild(n,C)),!0}},prepareNewTagNode:function(n,x){x=x||{};var A=this.settings,C=[],k={},L=Object.assign({},n,{value:n.value+""});if(n=Object.assign({},L),A.transformTag.call(this,n),n.__isValid=this.hasMaxTags()||this.validateTag(n),!0!==n.__isValid){if(x.skipInvalid)return;if(g(k,this.getInvalidTagAttrs(n,n.__isValid),{__preInvalidData:L}),n.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(n.value)),!A.createInvalidTags)return void C.push(n.value)}return"readonly"in n&&(n.readonly?k["aria-readonly"]=!0:delete n.readonly),{tagElm:this.createTagElem(n,k),tagData:n,aggregatedInvalidInput:C}},postProcessNewTagNode:function(n,x){var A=this,C=this.settings,k=x.__isValid;k&&!0===k?(this.value.push(x),this.trigger("add",{tag:n,index:this.value.length-1,data:x})):(this.trigger("invalid",{data:x,index:this.value.length,tag:n,message:k}),C.keepInvalidTags||setTimeout((function(){return A.removeTags(n,!0)}),1e3)),this.dropdown.position()},selectTag:function(n,x){var A=this;if(!this.settings.enforceWhitelist||this.isTagWhitelisted(x.value)){this.state.actions.selectOption&&setTimeout((function(){return A.setRangeAtStartEnd(!1,A.DOM.input)}));var C=this.getLastTag();return C?this.replaceTag(C,x):this.appendTag(n),this.value[0]=x,this.update(),this.trigger("add",{tag:n,data:x}),[n]}},addEmptyTag:function(n){var x=g({value:""},n||{}),A=this.createTagElem(x);y(A,x),this.appendTag(A),this.editTag(A,{skipValidation:!0}),this.toggleFocusClass(!0)},addTags:function(n,x,A){var C=this,k=[],L=this.settings,j=[],P=document.createDocumentFragment();if(!n||0==n.length)return k;switch(n=this.normalizeTags(n),L.mode){case"mix":return this.addMixTags(n);case"select":x=!1,this.removeAllTags()}return this.DOM.input.removeAttribute("style"),n.forEach((function(n){var x=C.prepareNewTagNode(n,{skipInvalid:A||L.skipInvalid});if(x){var V=x.tagElm;if(n=x.tagData,j=x.aggregatedInvalidInput,k.push(V),"select"==L.mode)return C.selectTag(V,n);P.appendChild(V),C.postProcessNewTagNode(V,n)}})),this.appendTag(P),this.update(),n.length&&x&&(this.input.set.call(this,L.createInvalidTags?"":j.join(L._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),L.dropdown.enabled&&this.dropdown.refilter(),k},addMixTags:function(n){var x=this;if((n=this.normalizeTags(n))[0].prefix||this.state.tag)return this.prefixedTextToTag(n[0]);var A=document.createDocumentFragment();return n.forEach((function(n){var C=x.prepareNewTagNode(n);A.appendChild(C.tagElm),x.insertAfterTag(C.tagElm),x.postProcessNewTagNode(C.tagElm,C.tagData)})),this.appendMixTags(A),A.children},appendMixTags:function(n){var x=!!this.state.selection;x?this.injectAtCaret(n):(this.DOM.input.focus(),(x=this.setStateSelection()).range.setStart(this.DOM.input,x.range.endOffset),x.range.setEnd(this.DOM.input,x.range.endOffset),this.DOM.input.appendChild(n),this.updateValueByDOMTags(),this.update())},prefixedTextToTag:function(n){var x,A,C,k=this,L=this.settings,j=null===(x=this.state.tag)||void 0===x?void 0:x.delimiters;if(n.prefix=n.prefix||this.state.tag?this.state.tag.prefix:(L.pattern.source||L.pattern)[0],C=this.prepareNewTagNode(n),A=C.tagElm,this.replaceTextWithNode(A)||this.DOM.input.appendChild(A),setTimeout((function(){return A.classList.add(k.settings.classNames.tagNoAnimation)}),300),this.value.push(C.tagData),this.update(),!j){var P=this.insertAfterTag(A)||A;setTimeout(T,0,P)}return this.state.tag=null,this.postProcessNewTagNode(A,C.tagData),A},appendTag:function(n){var x=this.DOM,A=x.input;x.scope.insertBefore(n,A)},createTagElem:function(n,x){n.__tagId=m();var A,C=g({},n,$({value:c(n.value+"")},x));return function(n){for(var x,A=document.createNodeIterator(n,NodeFilter.SHOW_TEXT,null,!1);x=A.nextNode();)x.textContent.trim()||x.parentNode.removeChild(x)}(A=this.parseTemplate("tag",[C,this])),y(A,n),A},reCheckInvalidTags:function(){var n=this,x=this.settings;this.getTagElms(x.classNames.tagNotAllowed).forEach((function(A,C){var k=y(A),L=n.hasMaxTags(),j=n.validateTag(k),P=!0===j&&!L;if("select"==x.mode&&n.toggleScopeValidation(j),P)return k=k.__preInvalidData?k.__preInvalidData:{value:k.value},n.replaceTag(A,k);A.title=L||j}))},removeTags:function(n,x,A){var C,k=this,L=this.settings;if(n=n&&G(n,HTMLElement)?[n]:G(n,Array)?n:n?[n]:[this.getLastTag()].filter((function(n){return n})),C=n.reduce((function(n,x){x&&"string"==typeof x&&(x=k.getTagElmByValue(x));var A=y(x);return x&&A&&!A.readonly&&n.push({node:x,idx:k.getTagIdx(A),data:y(x,{__removed:!0})}),n}),[]),A="number"==typeof A?A:this.CSSVars.tagHideTransition,"select"==L.mode&&(A=0,this.input.set.call(this)),1==C.length&&"select"!=L.mode&&C[0].node.classList.contains(L.classNames.tagNotAllowed)&&(x=!0),C.length)return L.hooks.beforeRemoveTag(C,{tagify:this}).then((function(){var t=function(n){n.node.parentNode&&(n.node.parentNode.removeChild(n.node),x?L.keepInvalidTags&&this.trigger("remove",{tag:n.node,index:n.idx}):(this.trigger("remove",{tag:n.node,index:n.idx,data:n.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),L.keepInvalidTags&&this.reCheckInvalidTags()))};A&&A>10&&1==C.length?function(n){n.node.style.width=parseFloat(window.getComputedStyle(n.node).width)+"px",document.body.clientTop,n.node.classList.add(L.classNames.tagHide),setTimeout(t.bind(this),A,n)}.call(k,C[0]):C.forEach(t.bind(k)),x||(k.removeTagsFromValue(C.map((function(n){return n.node}))),k.update(),"select"==L.mode&&L.userInput&&k.setContentEditable(!0))})).catch((function(n){}))},removeTagsFromDOM:function(){this.getTagElms().forEach((function(n){return n.remove()}))},removeTagsFromValue:function(n){var x=this;(n=Array.isArray(n)?n:[n]).forEach((function(n){var A=y(n),C=x.getTagIdx(A);C>-1&&x.value.splice(C,1)}))},removeAllTags:function(n){var x=this;n=n||{},this.value=[],"mix"==this.settings.mode?this.DOM.input.innerHTML="":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout((function(){x.DOM.input.focus()})),"select"==this.settings.mode&&(this.input.set.call(this),this.settings.userInput&&this.setContentEditable(!0)),this.update(n)},postUpdate:function(){this.state.blockChangeEvent=!1;var n,x,A=this.settings,C=A.classNames,k="mix"==A.mode?A.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;(this.toggleClass(C.hasMaxTags,this.value.length>=A.maxTags),this.toggleClass(C.hasNoTags,!this.value.length),this.toggleClass(C.empty,!k),"select"==A.mode)&&this.toggleScopeValidation(null===(x=this.value)||void 0===x||null===(n=x[0])||void 0===n?void 0:n.__isValid)},setOriginalInputValue:function(n){var x=this.DOM.originalInput;this.settings.mixMode.integrated||(x.value=n,x.tagifyValue=x.value,this.setPersistedData(n,"value"))},update:function(n){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout(function(){var x=this.getInputValue();this.setOriginalInputValue(x),this.settings.onChangeAfterBlur&&(n||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent();this.postUpdate()}.bind(this),100),this.events.bindOriginaInputListener.call(this,100)},getInputValue:function(){var n=this.getCleanValue();return"mix"==this.settings.mode?this.getMixedTagsAsString(n):n.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(n):JSON.stringify(n):""},getCleanValue:function(n){return a(n||this.value,this.dataProps)},getMixedTagsAsString:function(){var n="",x=this,A=this.settings,C=A.originalInputValueFormat||JSON.stringify,k=A.mixTagsInterpolator;return function i(A){A.childNodes.forEach((function(A){if(1==A.nodeType){var L=y(A);if("BR"==A.tagName&&(n+="\r\n"),L&&v.call(x,A)){if(L.__removed)return;n+=k[0]+C(o(L,x.dataProps))+k[1]}else A.getAttribute("style")||["B","I","U"].includes(A.tagName)?n+=A.textContent:"DIV"!=A.tagName&&"P"!=A.tagName||(n+="\r\n",i(A))}else n+=A.textContent}))}(this.DOM.input),n}},Y.prototype.removeTag=Y.prototype.removeTags;export{Y as default};

